<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
	<script type="text/javascript">
		window.onload = window.history.forward(0);
	</script>
</h:head>
<h:body>
	<ui:composition template="/template.xhtml">
		<ui:define name="content">

			<h:form prependId="false">
				<p:messages closable="true" autoUpdate="true"></p:messages>
				<div class="image-box-footer">
					<p:commandButton value="#{msg['add']}" immediate="true"
						onclick="PF('print-barcode-dlg').show()"
						icon="ui-icon ui-icon-add" styleClass="green-btn">
					</p:commandButton>
					<br /> <br />
				</div>
				<div class="card card-w-title" dir="rtl">
					<h1 style="color: #7CB342; text-align: center;">
						#{msg['penalties']}<span class="fa fa-fw fa-clock-o"></span>
					</h1>

					<p:dataTable var="wrkFinerItem" id="finesTab"
						value="#{penaltiesBean.wrkFines}" emptyMessage="لايوجد بيانات"
						rowIndexVar="rowOutIndex" paginatorPosition="bottom"
						widgetVar="outfineset" editable="true"
						filteredValue="#{penaltiesBean.filteredWrkFines}"
						paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
						paginator="true" rows="10">
						<f:facet name="header">
							<p:outputPanel>
								<h:outputText value="ابحث فى كل الحقول:" />&nbsp;&nbsp; 
											<p:inputText id="globalFilter"
									onkeyup="PF('outfineset').filter()"
									style="width:150px;font-size: x-large;"
									placeholder="كلمة البحث">
								</p:inputText>
								<div class="col-md-2"></div>
								<div class="col-md-3"></div>
							</p:outputPanel>
							<br />
						</f:facet>
						<p:ajax event="rowEdit" listener="#{penaltiesBean.onRowEdit}" />
						<p:ajax event="rowEditCancel" 
							listener="#{penaltiesBean.onRowCancel}" />
						<p:column style="text-align: center;" headerText="رقم " width="3%">
                                   #{rowOutIndex +1}
                                </p:column>
						<p:column style="white-space: nowrap;"
							headerText="#{msg['national.id']}"
							filterBy="#{wrkFinerItem.fnIdNo}" filterMatchMode="contains"
							width="15%">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{wrkFinerItem.fnIdNo}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{wrkFinerItem.fnIdNo}" style="width:100%"
										 />
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column width="20%" style="text-align:right"
							headerText="#{msg['name']}" filterBy="#{wrkFinerItem.fnIdName}"
							filterMatchMode="contains">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{wrkFinerItem.fnIdName}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{wrkFinerItem.fnIdName}"
										style="width:100%"  />
								</f:facet>
							</p:cellEditor>
						</p:column>

						<p:column headerText="رقم الجوال"
							style="white-space: nowrap;text-align: center;" width="10%"
							filterBy="#{wrkFinerItem.fnIdPhone}" filterMatchMode="contains">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{wrkFinerItem.fnIdPhone}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText required="true" style="width:100%"
										requiredMessage="رقم الجوال مطلوب"
										validator="utilities.PhoneNumberValidator"
										value="#{wrkFinerItem.fnIdPhone}">
									</p:inputText>

								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column headerText="رقم المخالفة"
							style="white-space: nowrap;text-align: center;" width="10%"
							filterBy="#{wrkFinerItem.fnCode}" filterMatchMode="contains">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{wrkFinerItem.fnCode}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{wrkFinerItem.fnCode}" style="width:100%"
										 />
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column headerText="رقم الفاتورة"
							style="white-space: nowrap;text-align: center;" width="10%"
							filterBy="#{wrkFinerItem.fnBillNoStr}" filterMatchMode="contains">										
										#{wrkFinerItem.fnBillNoStr}									
									</p:column>
						<p:column headerText="تاريخ الفاتورة"
							style="white-space: nowrap;text-align: center;" width="8%"
							filterBy="#{wrkFinerItem.fnDate}" filterMatchMode="contains">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{wrkFinerItem.fnDate}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText id="hiri1" value="#{wrkFinerItem.fnDate}"
										onfocus="loadCalendar();" required="true"
										requiredMessage="يرجى اختيار تاريخ"
										styleClass="form-control form-controlCal">
									</p:inputText>

								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column headerText="المبلغ"
							style="white-space: nowrap;text-align: center;" width="10%"
							filterBy="#{wrkFinerItem.amount}" filterMatchMode="contains">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{wrkFinerItem.amount}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText value="#{wrkFinerItem.amount}" style="width:100%"
									 />
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column headerText="الحالة"
							style="white-space: nowrap;text-align: center;" width="10%"
							filterBy="#{wrkFinerItem.billSatatus}" filterMatchMode="contains">
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText
										value="#{wrkFinerItem.billSatatus == 1 ? 'مسددة':'غير مسددة'}" />
								</f:facet>
								<f:facet name="input">
									<p:selectOneMenu id="typ" style="width:100%"
										value="#{wrkFinerItem.billSatatus}" var="d">
										<f:selectItem itemLabel="مسددة" itemValue="1" />
										<f:selectItem itemLabel="غير مسددة" itemValue="0" />
									</p:selectOneMenu>
								</f:facet>
							</p:cellEditor>
						</p:column>
						<p:column style="width:5%" headerText="تعديل">
							<p:rowEditor />
						</p:column>
						<p:column headerText="إرسال"
							style="white-space: nowrap;text-align: center;" width="10%">
							<p:commandButton icon="ui-icon ui-icon-assignment-return"
								immediate="true" value="الأمانة"></p:commandButton>
							<!-- 								 action="#{penaltiesBean.addpenalty}" -->

						</p:column>
					</p:dataTable>
					<!-- 					</p:panel> -->
				</div>


				<p:dialog widgetVar="print-barcode-dlg" id="confirmSigndialog"
					width="50%" hideEffect="fade" showEffect="explode" dir="rtl"
					modal="true" resizable="false">
					<h:panelGroup>
						<p:fieldset width="100%" legend="بيانات المخالفة">
							<!-- 							<div class="ui-g"> -->
							<!-- 								<div class="ui-g-1"> -->
							<!-- 									<h:outputLabel value="هجري" /> -->
							<!-- 								</div> -->
							<!-- 								<div class="ui-g-2"> -->
							<!-- 									<p:selectBooleanCheckbox value="#{recordBean.higriMode}"> -->
							<!-- 										<p:ajax update="pDates1" process="@this"></p:ajax> -->
							<!-- 									</p:selectBooleanCheckbox> -->
							<!-- 								</div> -->
							<!-- 							</div> -->
							<div class="ui-g" dir="rtl">
								<div class="ui-g-2">
									<h:outputLabel value="تاريخ المخالفة" />
								</div>
								<div class="ui-g-3">
									<h:panelGroup id="pDates1" style="width: 30%">
										<p:inputText id="hiri1"
											value="#{penaltiesBean.wrkFiner.fnDate}"
											onfocus="loadCalendar();" required="true"
											requiredMessage="يرجى اختيار تاريخ"
											styleClass="form-control form-controlCal">
										</p:inputText>
										<!-- 										<p:calendar id="gric1" value="#{recordBean.recGDate}" -->
										<!-- 											pattern="dd/MM/yyyy" rendered="#{not recordBean.higriMode}"> -->
										<!-- 										</p:calendar> -->
									</h:panelGroup>

									<!-- 									<p:inputText required="true" style="width:100%" maxlength="8" -->
									<!-- 										requiredMessage="مطلوب تاريخ المخالفة" -->
									<!-- 										value="#{penaltiesBean.wrkFiner.fnDate}"> -->
									<!-- 										<f:convertNumber type="number"></f:convertNumber> -->
									<!-- 									</p:inputText> -->
								</div>

								<div class="ui-g-2">
									<h:outputLabel value="رقم السجل" />
								</div>
								<div class="ui-g-3">
									<p:inputText id="fnIdNo1" maxlength="10" maxValue="9999999999"
										dir="rtl" required="true" requiredMessage="رقم السجل مطلوب"
										validatorMessage="رقم السجل ارقام" minValue="1"
										style="width:100%" value="#{penaltiesBean.wrkFiner.fnIdNo}">
										<f:convertNumber type="number"></f:convertNumber>
									</p:inputText>
								</div>

							</div>
							<div class="ui-g">
								<div class="ui-g-2">
									<h:outputLabel value="إسم المخالف" />
								</div>
								<div class="ui-g-3">
									<p:inputText id="fnName1" required="true" style="width:100%"
										value="#{penaltiesBean.wrkFiner.fnIdName}"
										requiredMessage="إسم المخالف مطلوب" />

								</div>
								<div class="ui-g-2">
									<h:outputLabel value="رقم المخالفة" />
								</div>
								<div class="ui-g-3">
									<p:inputText maxlength="10" maxValue="9999999999"
										required="true" requiredMessage="رقم المخالفة مطلوب"
										value="#{penaltiesBean.wrkFiner.fnCode}" minValue="1"
										style="width:100%">
										<f:convertNumber type="number"></f:convertNumber>
									</p:inputText>
								</div>


							</div>

							<div class="ui-g">
								<div class="ui-g-2">
									<h:outputLabel value="شرح المخالفة" />
								</div>
								<div class="ui-g-3">
									<p:inputText required="true" style="width:100%"
										value="#{penaltiesBean.wrkFiner.notes}"
										requiredMessage="شرح المخالفة" />
								</div>

								<div class="ui-g-2">
									<h:outputLabel value="رقم الفاتورة" />
								</div>
								<div class="ui-g-3">
									<p:inputText maxlength="10" maxValue="9999999999" dir="rtl"
										required="true" requiredMessage="رقم المخالفة مطلوب"
										value="#{penaltiesBean.wrkFiner.fnBillNo}" minValue="1"
										style="width:100%">
										<f:convertNumber type="number"></f:convertNumber>
									</p:inputText>
								</div>
							</div>
							<div class="ui-g">
								<div class="ui-g-2">
									<h:outputLabel value="قيمة الفاتورة" />
								</div>
								<div class="ui-g-3">
									<p:inputText required="true" style="width:100%"
										requiredMessage="قيمة الفاتورة مطلوب"
										value="#{penaltiesBean.wrkFiner.amount}">
										<f:convertNumber type="number"></f:convertNumber>
									</p:inputText>
								</div>
								<div class="ui-g-2">
									<h:outputLabel value="رقم الجوال" />
								</div>
								<div class="ui-g-3">
									<p:inputText required="true" style="width:100%"
										requiredMessage="رقم الجوال مطلوب"
										validator="utilities.PhoneNumberValidator"
										value="#{penaltiesBean.wrkFiner.fnIdPhone}">
										<f:convertNumber type="number"></f:convertNumber>
									</p:inputText>
								</div>
							</div>
							<div class="ui-g">
								<div class="ui-g-2">
									<h:outputLabel value="حالة المخالفة" />
								</div>
								<div class="ui-g-3">
									<p:selectOneMenu id="typ" required="true" style="width:100%"
										requiredMessage="حالة المخالفة مطلوب"
										value="#{penaltiesBean.wrkFiner.billSatatus}" var="d">
										<f:selectItem itemLabel="مسددة" itemValue="1" />
										<f:selectItem itemLabel="غير مسددة" itemValue="0" />
									</p:selectOneMenu>
								</div>
							</div>
						</p:fieldset>
					</h:panelGroup>

					<div style="float: left;">
						<p:commandButton value="#{msg['add']}" process="confirmSigndialog"
							action="#{penaltiesBean.addpenalty}"
							update="confirmSigndialog, finesTab">
						</p:commandButton>
						<!-- 						actionListener="#{penaltiesBean.addpenalty}" -->
						<p:spacer width="10" height="10"></p:spacer>
						<p:commandButton value="رجوع" immediate="true"
							icon="ui-icon ui-icon-keyboard-arrow-left"
							styleClass=" orange-btn" onclick="PF('print-barcode-dlg').hide()">
						</p:commandButton>
					</div>
				</p:dialog>
			</h:form>
		</ui:define>
	</ui:composition>
</h:body>
</html>
