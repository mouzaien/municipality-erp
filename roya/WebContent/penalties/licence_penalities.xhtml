<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core">
<f:view>
	<h:head>
		<link rel="apple-touch-icon" href="apple-touch-icon.png"></link>
		<script
			src="#{facesContext.externalContext.requestContextPath}/dropDownMenuCss/js/vendor/modernizr-2.8.3.min.js"></script>
		<script type="text/javascript"
			src="#{facesContext.externalContext.requestContextPath}/datatableCss4/js/jquery.dataTables.min.js"></script>


		<link rel="stylesheet"
			href="#{facesContext.externalContext.requestContextPath}/dropDownMenuCss/css/bootstrap/bootstrap.min.css"></link>
		<link rel="stylesheet"
			href="#{facesContext.externalContext.requestContextPath}/resources/css/PFDataTableCustomize.css"></link>

	</h:head>
	<ui:composition template="/template.xhtml">

		<ui:define name="content">
			<h:form id="includeform">
				<p:messages autoUpdate="true" closable="true"></p:messages>
				<div class="image-box-footer">
						<p:commandButton  value="تسجيل مخالفة"
							styleClass="btn btn-primary" immediate="true"
							action="#{searchPenaltyBean.addLicencePenality}">
						</p:commandButton>
					</div>
				<div class="card card-w-title" dir="rtl">
<!-- 				<h:panelGroup rendered="#{!searchPenaltyBean.withNationalId}"> -->
					
						<br></br>
<!-- 						<h1 style="color: #7CB342; text-align: center;"> -->
<!-- 				بيانات الرخصة<span class="fa fa-fw fa-clock-o"></span> -->
<!-- 			</h1> -->
					
						
							<p:fieldset rendered="#{!searchPenaltyBean.withNationalId}" legend="بيانات الرخصة"
						toggleable="true" toggleSpeed="500">
						<div>
								<div class="ui-g">
									
										<div class="ui-g-1">
											<p:outputLabel value="رقم الرخصة" styleClass="btxt" />
										</div>
										<div class="ui-g-3">
											<p:outputLabel
												value="#{searchPenaltyBean.trdMasterFile.licNo}" />
										</div>
										<div class="ui-g-1">
											<p:outputLabel value="#{msg['commercial.name']}"
												styleClass="btxt" />
										</div>
										<div class="ui-g-3">
											<p:outputLabel
												value="#{searchPenaltyBean.trdMasterFile.trdName}" />
										</div>
									


									
										<div class="ui-g-1">
											<p:outputLabel value="صاحب المنشأة" styleClass="btxt" />
										</div>
										<div class="ui-g-3">
											<p:outputLabel
												value="#{searchPenaltyBean.trdMasterFile.licOwnerName}" />
										</div>

									




									
										<div class="ui-g-1">
											<p:outputLabel value="عنوان المنشأة" styleClass="btxt" />
										</div>
										<div class="ui-g-3">
											<p:outputLabel
												value="#{searchPenaltyBean.trdMasterFile.licAdress}" />
										</div>

									


									
										<div class="ui-g-1">
											<p:outputLabel value="تاريخ بداية الرخصة" styleClass="btxt" />
										</div>
										<div class="ui-g-3">
											<p:outputLabel
												value="#{searchPenaltyBean.trdMasterFile.licBeginDate}" />
										</div>
										<div class="ui-g-1">
											<p:outputLabel value="تاريخ نهاية الرخصة" styleClass="btxt" />
										</div>
										<div class="ui-g-3">
											<p:outputLabel
												value="#{searchPenaltyBean.trdMasterFile.licEndDate}" />
										</div>
									

								</div>
								</div>
							</p:fieldset>
						
					
					<br />
					<br />
					
						
					

<!-- 				</h:panelGroup> -->









				<h:panelGroup id="natNo" rendered="#{searchPenaltyBean.withNationalId}">
					<div class="col-lg-12"
						style="background-color: white; border-top: 5px solid #428BCA">
						<br></br>
						<div style="color: color: #428bca">
							<h3 class="page-header"
								style="margin: 0px 0 20px ! important; color: #428bca">بيانات
								صاحب الرخصة</h3>
						</div>

						<div class="panel-body">
							<div class="row">
								<div class="col-md-12">
									<div class="row">
								
											<div class="col-md-2">
												<h:outputLabel value="#{msg['identity']}" styleClass="btxt" />
											</div>
											<div class="col-md-2">
												<h:outputLabel
													value="#{searchPenaltyBean.reqFinesMaster.fIdNo}" />
											</div>
											<div class="col-md-1">
												<p:commandButton type="button" update="natNo" icon="fa fa-fw fa-user"
													onclick="PF('dPeoples').show();" />
											</div>
											
											<div class="col-md-2">
												<h:outputLabel value="#{msg['name']}" styleClass="btxt" />
											</div>
											<div class="col-md-5">
												<h:outputLabel
													value="#{searchPenaltyBean.reqFinesMaster.fName}" />
											</div>
											
										
									</div>

								</div>

							</div>
						</div>
					</div>
				</h:panelGroup>

				
				
					
					
						<h3 class="page-header"
							style="margin: 0px 0 20px ! important; color: #428bca">قائمة
							المخالفات</h3>
					
						
						<p:dataTable dir="rtl" var="det" id="inboxdt"
								widgetVar="license"
									value="#{searchPenaltyBean.reqFinesMasterList}"
									emptyMessage="لايوجد بيانات" rowIndexVar="rowIndex"
									paginatorPosition="bottom"
									paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
									filteredValue="#{searchPenaltyBean.filteredList}"
									paginator="true" rows="17">
									<f:facet name="header">
					<p:outputPanel>
						<h:outputText value="ابحث فى كل الحقول:" />
						<p:inputText id="globalFilter" onkeyup="PF('license').filter()"
							style="width:50%" placeholder="كلمة البحث">
						</p:inputText>
					</p:outputPanel>
				</f:facet>

									<p:column style="text-align: center;" headerText="رقم المخالفة"
										filterBy="#{licenceItem.licNo}" filterMatchMode="contains"
										width="10%">
                                    #{det.fineNo}

                                </p:column>
									<p:column style="white-space: nowrap;"
										headerText="تاريخ المخالفة" width="55%"
										>										
										#{det.fineDate} 									
									</p:column>
									<p:column style="white-space: nowrap;text-align: center;"
										headerText="رقم الاثبات" width="15%"
										>										
										#{det.fIdNo}									
									</p:column>
									<p:column style="white-space: nowrap;text-align: center;"
										headerText="صاحب المخالفة" width="15%"
										
										>										
										#{det.fName}										
									</p:column>
									<p:column width="5%" style="text-align:center"
										headerText="رقم الرخصة">
										#{det.fLicenceNo}
									</p:column>
									<p:column width="5%" style="text-align:center"
										headerText="القيمة">
										#{det.totalValue}
									</p:column>
									<p:column width="5%" style="text-align:center"
										headerText="حالة الدفع">
										#{(det.fFineCase==2)? msg['paid']:msg['not.paid']}
									</p:column>
									<p:column width="5%" style="text-align:center"
										headerText="الرقم المميز">
										#{det.fKeycode}
									</p:column>
									<p:column width="5%" style="text-align:center"
										headerText="التفاصيل ">
										<p:commandButton 
														oncomplete="PF('detailsDG').show();"
														actionListener="#{searchPenaltyBean.DetailLic(det)}" process="@this"
														icon="ui-icon-search" update="includeform:myDialog">
<!-- 														<f:setPropertyActionListener value="#{det}" -->
<!-- 															target="#{searchPenaltyBean.reqFinesMaster}" /> -->
													</p:commandButton>
									</p:column>
									
								</p:dataTable>

<!-- 					<div class="row"> -->
<!-- 						<div class="col-md-12 "> -->

<!-- 							<div class="table-responsive" -->
<!-- 								style="position: relative; height: 300px; overflow-y: auto; width: 98%; padding-right: 27px;"> -->


<!-- 							<h:panelGroup id="penTable"> -->


<!-- 								<table id="exemple" class="table table-striped table-hover"> -->
<!-- 									<thead> -->
<!-- 										<tr> -->

<!-- 											<th>رقم المخالفة</th> -->
<!-- 											<th>تاريخ المخالفة</th> -->
<!-- 											<th>رقم الاثبات</th> -->
<!-- 											<th>صاحب المخالفة</th> -->
<!-- 											<h:panelGroup rendered="#{searchPenaltyBean.withNationalId}"> -->
<!-- 												<th>رقم الرخصة</th> -->
<!-- 											</h:panelGroup> -->
<!-- 											<th>القيمة</th> -->
<!-- 											<th>حالة الدفع</th> -->
<!-- 											<th>الرقم المميز</th> -->
<!-- 											<th>التفاصيل</th> -->

<!-- 										</tr> -->
<!-- 									</thead> -->
<!-- 									<tbody> -->
<!-- 										<ui:repeat var="det" varStatus="x" -->
<!-- 											value="#{searchPenaltyBean.reqFinesMasterList}"> -->


<!-- 											<tr> -->

<!-- 												<td>#{det.fineNo}</td> -->
<!-- 												<td>#{det.fineDate}</td> -->
<!-- 												<td>#{det.fIdNo}</td> -->
<!-- 												<td>#{det.fName}</td> -->
<!-- 												<h:panelGroup rendered="#{searchPenaltyBean.withNationalId}"> -->
<!-- 													<td>#{det.fLicenceNo}</td> -->
<!-- 												</h:panelGroup> -->
<!-- 												<td>#{det.totalValue}</td> -->
<!-- 												<td>#{(det.fFineCase==2)? msg['paid']:msg['not.paid']}</td> -->
<!-- 												<td>#{det.fKeycode}</td> -->
<!-- 												<td><p:commandButton -->
<!-- 														oncomplete="PF('detailsDG').show();" -->
<!-- 														action="#{searchPenaltyBean.DetailLic}" process="@this" -->
<!-- 														icon="ui-icon-search" update="includeform:myDialog"> -->
<!-- 														<f:setPropertyActionListener value="#{det}" -->
<!-- 															target="#{searchPenaltyBean.reqFinesMaster}" /> -->
<!-- 													</p:commandButton></td> -->
<!-- 											</tr> -->
<!-- 										</ui:repeat> -->
<!-- 									</tbody> -->
<!-- 								</table> -->
<!-- 								</h:panelGroup> -->
<!-- 							</div> -->
<!-- 						</div> -->
<!-- 					</div> -->
				
				<br></br>
				
					<p:commandButton style="float:left;" value="رجوع"
						 immediate="true"
						action="SearchPenality">
					</p:commandButton>
				
				<hr></hr>
				
				
				<p:dialog widgetVar="detailsDG" id="details_dlgId" width="70%" header="التفاصيل" style="margin-top: -60px;"
						 hideEffect="fade" showEffect="explode" height="70%"
						dir="rtl" modal="true" resizable="false">
					<h:panelGroup id="myDialog">
<!-- 						<div class="modal-dialog modal-lg " style="clear: both;" -->
<!-- 							role="document"> -->
<!-- 							<div class="modal-content"> -->
<!-- 								<div class="modal-header"> -->
<!-- 									<button type="button" class="close" data-dismiss="modal" -->
<!-- 										aria-label="Close"> -->
<!-- 										<span aria-hidden="true"></span> -->
<!-- 									</button> -->
<!-- 									<h4 class="modal-title" id="gridModalLabel">التفاصيل</h4> -->
<!-- 								</div> -->
								
									
										
										
											<h4 class="page-header"
												style="margin: 0px 58px 20px ! important; color: #FF5722">بيانات
												المخالفة</h4>

											
												
													<div class="ui-g">
														
															<div class="ui-g-1">
																<label class="btxt">رقم الرخصة</label>

															</div>
															<div class="ui-g-3">
																<h:outputLabel
																	value="#{searchPenaltyBean.reqFinesMaster.fLicenceNo}" />
															</div>

															<div class="ui-g-1">
																<label class="btxt">المخطط</label>

															</div>
															<div class="ui-g-3">
																<h:outputLabel
																	value="#{searchPenaltyBean.reqFinesMaster.fMapNo}" />
															</div>


															<div class="ui-g-1">
																<label class="btxt">القطعة</label>

															</div>
															<div class="ui-g-3">
																<h:outputLabel
																	value="#{searchPenaltyBean.reqFinesMaster.fBlockNo}" />
															</div>


													
													


													
															<div class="ui-g-1">
																<label class="btxt">رقم المخالفة</label>

															</div>
															<div class="ui-g-3">
																<h:outputLabel
																	value="#{searchPenaltyBean.reqFinesMaster.fineNo}" />
															</div>
															<div class="ui-g-1">
																<label class="btxt">رقم المحضر</label>

															</div>
															<div class="ui-g-3">
																<h:outputLabel
																	value="#{searchPenaltyBean.reqFinesMaster.fReportNo}" />
															</div>

															<div class="ui-g-1">
																<label class="btxt">الرقم المميز</label>

															</div>
															<div class="ui-g-3">
																<h:outputLabel
																	value="#{searchPenaltyBean.reqFinesMaster.fKeycode}" />
															</div>
														
												
												

												
														


															<div class="ui-g-1">
																<label class="btxt">حالة المخالفة</label>

															</div>
															<div class="ui-g-3">
																<h:outputLabel
																	value="#{(searchPenaltyBean.reqFinesMaster.fFineCase==2)? msg['paid']:msg['not.paid']}" />
															</div>


															<div class="ui-g-1">
																<label class="btxt">تاريخ المحضر</label>

															</div>
															<div class="ui-g-3">
																<h:outputLabel
																	value="#{searchPenaltyBean.reqFinesMaster.fineDate}" />
															</div>
															<div class="ui-g-1">
																<label class="btxt">نوع النشاط</label>

															</div>
															<div class="ui-g-3">
																<h:outputLabel
																	value="#{(searchPenaltyBean.reqFinesMaster.activityType==0)? msg['healthy']:msg['commercial']}" />
															</div>

														</div>

												
												<br />
												

													<div class="ui-g">
														


															<div class="ui-g-1">
																<label class="btxt">الإدارة المختصة</label>

															</div>
															<div class="ui-g-3">
																<h:outputLabel
																	value="#{searchPenaltyBean.reqFinesMaster.deptName}" />
															</div>

															<div class="ui-g-1">
																<label class="btxt">المراقب</label>

															</div>
															<div class="ui-g-3">
																<h:outputLabel
																	value="#{searchPenaltyBean.reqFinesMaster.supervisorName}" />
															</div>
														


													</div>
												

										
											<br />
											

												<div class="ui-g">
													


														<div class="ui-g-1">
															<label class="btxt">شرح المخالفة</label>

														</div>
														<div class="ui-g-11">
															<h:outputLabel
																value="#{searchPenaltyBean.reqFinesMaster.fFineDesc}" />
														</div>



													
												</div>

											
											<br />
											

												<div class="ui-g">
													
														<div class="ui-g-1">
															<label class="btxt">رقم التبليغ</label>

														</div>
														<div class="ui-g-3">
															<h:outputLabel
																value="#{searchPenaltyBean.reqFinesMaster.fLetterNo}" />
														</div>
														<div class="ui-g-1">
															<label class="btxt">تاريخ الإغلاق</label>

														</div>
														<div class="ui-g-3">
															<h:outputLabel
																value="#{searchPenaltyBean.reqFinesMaster.fCloseDate}" />
														</div>
														<div class="ui-g-1">
															<label class="btxt">تاريخ الفسخ</label>

														</div>
														<div class="ui-g-3">
															<h:outputLabel
																value="#{searchPenaltyBean.reqFinesMaster.fReopenDate}" />
														</div>
													
												</div>

											
										

										<br />
	
	<p:dataTable  dir="rtl" var="def" id="details"
								widgetVar="bill"
									value="#{searchPenaltyBean.lstReqFinesDetails}"
									emptyMessage="لايوجد بيانات" rowIndexVar="rowIndex"
									paginatorPosition="bottom"
									paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
									filteredValue="#{searchPenaltyBean.filteredDetailList}"
									paginator="true" rows="17">
									<f:facet name="header">
					<p:outputPanel>
						<h:outputText value="ابحث فى كل الحقول:" />
						<p:inputText id="globalFilter" onkeyup="PF('bill').filter()"
							style="width:50%" placeholder="كلمة البحث">
						</p:inputText>
					</p:outputPanel>
				</f:facet>

									<p:column style="text-align: center;" headerText="بيان الغرامة"
										filterBy="#{licenceItem.licNo}" filterMatchMode="contains"
										width="10%">
                                    #{def.reqFinesSetup.fineDesc}

                                </p:column>
									<p:column style="white-space: nowrap;"
										headerText="الحد الادني " width="55%"
										>										
										#{def.reqFinesSetup.fineMinimumValue} 									
									</p:column>
									<p:column style="white-space: nowrap;text-align: center;"
										headerText="الحد الاعلي " width="15%"
										>										
										#{def.reqFinesSetup.fineSupermumValue}									
									</p:column>
									<p:column style="white-space: nowrap;text-align: center;"
										headerText="عدد المخالفات " width="15%"
										
										>										
										#{def.fineCount}										
									</p:column>
									<p:column width="5%" style="text-align:center"
										headerText="قيمة الغرامة ">
										#{def.fineValue}
									</p:column>
									<p:column width="5%" style="text-align:center"
										headerText="اجمالي الغرامة">
										#{def.fineTotalValue}
									</p:column>
	</p:dataTable>								

									
<!-- 		<table class="table table-striped table-hover"> -->
<!-- 					<thead> -->
<!-- 								<tr> -->

<!-- 									<th>بيان الغرامة</th> -->
<!-- 				    				<th>الحد الادنى</th> -->
<!-- 									<th>الحد الأعلى</th> -->
<!-- 									<th>عدد المخالفات</th> -->
<!-- 		   				<th>قيمةالغرامة</th> -->
<!-- 							       <th>إجمالي الغرامة</th> -->


<!-- 																	</tr> -->
<!-- 																</thead> -->
<!-- 																<tbody> -->
<!-- 																	<ui:repeat var="fdet" varStatus="x" -->
<!-- 																		value="#{searchPenaltyBean.lstReqFinesDetails}"> -->


<!-- 																		<tr> -->

<!-- 																			<td>#{fdet.reqFinesSetup.fineDesc}</td> -->
<!-- 																			<td>#{fdet.reqFinesSetup.fineMinimumValue}</td> -->
<!-- 																			<td>#{fdet.reqFinesSetup.fineSupermumValue}</td> -->
<!-- 																			<td>#{fdet.fineCount}</td> -->
<!-- 																			<td>#{fdet.fineValue}</td> -->
<!-- 																			<td>#{fdet.fineTotalValue}</td> -->

<!-- 																		</tr> -->

<!-- 																	</ui:repeat> -->
<!-- 																</tbody> -->
<!-- 															</table> -->
														
											<br />

										

										<br />
									

									<div>
										<p:commandButton value="رجوع" immediate="true" style="float: left;"
							onclick="PF('detailsDG').hide();"></p:commandButton>
									</div>
</h:panelGroup>
</p:dialog>		
			<br></br>						
<!-- 							</div> -->
<!-- 						</div> -->
					
					
<!-- 				</div> -->
				<p:dialog header="تحديد" widgetVar="dPeoples" modal="true"
					width="50%" dir="rtl" minHeight="50">
					<p:dataTable value="#{loadingDataBean.arcPeoples}"
						style="width:100%" selectionMode="single"
						selection="#{penaltyBean.selectedPeople}" var="people" id="ARCpDT"
						paginator="true" rows="12" emptyMessage="لا يوجد"
						rowKey="#{people.nationalId}"
						filteredValue="#{searchPenaltyBean.filteredArcPeoples}"
						paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}">
						<p:ajax event="rowSelect"
							listener="#{searchPenaltyBean.onRowSelect}"></p:ajax>
						<p:column style="text-align: center;" headerText="رقم"
							filterBy="#{people.nationalId}" width="10%"
							filterMatchMode="contains">
                                    #{people.nationalId}
                                </p:column>
						<p:column style="white-space: nowrap;"
							headerText="#{msg['commercial.name']}" width="55%"
							filterBy="#{people.completeName}" filterMatchMode="contains">										
										#{people.completeName}										
									</p:column>
					</p:dataTable>
					<br/>
					<div class="row" align="center">
						<h:commandButton value="موافق" styleClass="btn btn-primary"
							action="#{searchPenaltyBean.checkLic}">
							<p:ajax process="@form" oncomplete="PF('dPeoples').hide();"
								update="includeform:natNo"></p:ajax>
						</h:commandButton>
						<button type="button" class="btn btn-primary"
							onclick="PF('dPeoples').hide();">رجوع</button>
					</div>
				</p:dialog>
				<br></br>
				<br></br>
				</div>
			</h:form>

		</ui:define>
	</ui:composition>

</f:view>
</html>
