<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core">
<f:view>

	<!-- 	<h:head> -->

	<!-- 		<link -->
	<!-- 			href="#{facesContext.externalContext.requestContextPath}/resources/css/style.css" -->
	<!-- 			rel="stylesheet" type="text/css"></link> -->
	<!-- 	</h:head> -->

	<!--	<script type="text/javascript">  
	 	window.onload = window.history.forward(0);
 	</script> \
 	-->
	<br />
	<h:body>

		<ui:composition template="/template.xhtml">
			<p:growl autoUpdate="true" showDetail="false" />

			<ui:define name="content">
				<h:form id="includeform">
					<p:messages autoUpdate="true" closable="true"></p:messages>
					<div class="card card-w-title" dir="rtl">
						<h1 style="color: #7CB342; text-align: center;">#{msg['notification.list']}
						</h1>
						<!-- 						<div class="ui-g"> -->
						<!-- 							<div class="ui-g-2"> -->
						<!-- 								<p:outputLabel value="حالة الإشعار" /> -->
						<!-- 							</div> -->
						<!-- 							<div class="ui-g-2"> -->
						<!-- 								<p:selectOneMenu value="#{notifPenalitiesBean.status}" -->
						<!-- 									autoWidth="true"> -->
						<!-- 									<f:selectItem itemLabel="اختر الحالة" -->
						<!-- 										noSelectionOption="#{null}" /> -->
						<!-- 									<f:selectItem itemLabel="إشعار" itemValue="0" /> -->
						<!-- 									<f:selectItem itemLabel="مخالفة" itemValue="1" /> -->
						<!-- 									<f:selectItem itemLabel="ملغى" itemValue="2" /> -->
						<!-- 									<f:ajax render="@form" execute="@this" event="change" -->
						<!-- 										listener="#{notifPenalitiesBean.loadNotifPenalities}" /> -->
						<!-- 								</p:selectOneMenu> -->
						<!-- 							</div> -->
						<!-- 						</div> -->
						<br />
						<p:dataTable var="penalItem"
							value="#{notifPenalitiesBean.notifPenalitiesList}" id="inboxdt"
							widgetVar="penal_dt" paginator="true" paginatorPosition="bottom"
							rows="10" emptyMessage="لا يوجد" rowIndexVar="rowIndex"
							filteredValue="#{notifPenalitiesBean.filteredNotifPenalities}"
							paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}">

							<f:facet name="header">
								<p:outputPanel>
									<h:outputText value="ابحث فى كل الحقول:" />
									<p:inputText id="globalFilter"
										onkeyup="PF('penal_dt').filter()" style="width:150px"
										placeholder="كلمة البحث">
									</p:inputText>
								</p:outputPanel>
							</f:facet>
							<p:column style="text-align: center;" headerText="رقم المسلسل"
								filterBy="#{rowIndex + 1}" filterMatchMode="contains" width="5%">
                                    #{rowIndex + 1}
                               </p:column>
							<p:column style="text-align: center;"
								headerText="#{msg['notif.number']}" filterBy="#{penalItem.id}"
								filterMatchMode="contains" width="15%">
                                    #{penalItem.id}
                                </p:column>
							<p:column style="white-space: nowrap;text-align: center;"
								headerText="#{msg['licence.number']}" width="20%"
								filterBy="#{penalItem.licNo}" filterMatchMode="contains">										
										#{penalItem.licNo}										
									</p:column>
							<p:column style="white-space: nowrap;text-align: center;"
								headerText="#{msg['date']}" width="20%"
								filterBy="#{penalItem.notifDate}" filterMatchMode="contains">
								<h:outputText value="#{penalItem.notifDate}">
									<f:convertDateTime pattern="yyyy/MM/dd" />
								</h:outputText>
							</p:column>
							<p:column style="white-space: nowrap;text-align: center;"
								headerText="#{msg['status']}" width="5%">
								<h:outputText
									value="#{(penalItem.evaluation == 1)? 'مناسب':'غيرمناسب'}" />
							</p:column>
							<!-- 							<p:column style="white-space: nowrap;text-align: center;" -->
							<!-- 								headerText="الشرح" width="30%"> -->
							<!-- 								<h:outputText -->
							<!-- 									value="#{penalItem.observation}" /> -->
							<!-- 							</p:column> -->
							<p:column width="5%" style="text-align:center"
								headerText="#{msg['details']}">
								<p:commandButton
									action="#{notifPenalitiesBean.loadSelectedNotification(penalItem)}"
									process="@this" icon="ui-icon-search"
									update="includeform:dlgid">
								</p:commandButton>
							</p:column>
							<p:column width="10%" style="text-align:center"
								headerText="تسجيل مخالفة">
								<h:outputText rendered="#{penalItem.penaltyIsRecoreded == 'Y'}"
									value="تمت اضافة مخالفة " />
								<p:commandButton icon="ui-icon-plus"
									rendered="#{penalItem.penaltyIsRecoreded != 'Y'}"
									action="#{notifPenalitiesBean.addPenalty(penalItem)}">
								</p:commandButton>
							</p:column>
							<p:column width="7%" style="text-align:center"
								headerText=" طباعة المحضر">
								<p:commandButton ajax="false" icon="ui-icon-print"
									onclick="this.form.target='_blank'" styleClass="purple-btn"
									action="#{notifPenalitiesBean.printNotifReport}">
									<f:setPropertyActionListener value="#{penalItem}"
										target="#{notifPenalitiesBean.notifFinesMaster}" />
								</p:commandButton>

							</p:column>
						</p:dataTable>
						<br />
						<p:dialog widgetVar="details_dlg" id="dlgid" width="80%"
							hideEffect="fade" showEffect="explode" dir="rtl" modal="true"
							resizable="false">
							<h:panelGroup id="pngid">
								<p:fieldset legend="التفاصيل">
									<div class="ui-g">
										<div class="ui-g-2">
											<h:outputLabel value="#{msg['notif.number']} " />
										</div>
										<div class="ui-g-2">
											<h:outputLabel style="text-align: center"
												value="#{notifPenalitiesBean.notifFinesMaster.id}" />
										</div>
										<div class="ui-g-2">
											<h:outputLabel value="المراقب" />
										</div>
										<div class="ui-g-2">
											<h:outputLabel value="#{notifPenalitiesBean.supervisorName}" />
										</div>
									</div>
									<div class="ui-g">
										<div class="ui-g-2">
											<h:outputLabel value="رقم الرخصة" />
										</div>
										<div class="ui-g-2">
											<h:outputLabel style="text-align: center"
												value="#{notifPenalitiesBean.notifFinesMaster.licNo}" />
										</div>
										<div class="ui-g-2">
											<h:outputLabel value="صاحب الرخصة" />
										</div>
										<div class="ui-g-2">
											<h:outputLabel style="text-align: center"
												value="#{notifPenalitiesBean.notifFinesMaster.licOwner}" />
										</div>
									</div>
									<div class="ui-g">
										<p:dataTable var="notfiItem"
											value="#{notifPenalitiesBean.notifFinesMaster.notifFinesDetailsList}"
											widgetVar="penal_dt" paginator="true"
											paginatorPosition="bottom" rows="10" emptyMessage="لا يوجد"
											rowIndexVar="rowIndex"
											filteredValue="#{notifPenalitiesBean.filteredNotifPenalities}"
											paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}">

											<f:facet name="header">
												<p:outputPanel>
													<h:outputText value="ابحث فى كل الحقول:" />
													<p:inputText id="globalFilter"
														onkeyup="PF('penal_dt').filter()" style="width:150px"
														placeholder="كلمة البحث">
													</p:inputText>
												</p:outputPanel>
											</f:facet>
											<p:column style="text-align: center;" headerText=" المسلسل"
												filterBy="#{rowIndex + 1}" filterMatchMode="contains"
												width="7%">
												<h:outputText value="#{rowIndex + 1}" />

											</p:column>
											<p:column style="text-align: center;"
												headerText="نوع المخالفة"
												filterBy="#{notfiItem.fineRoleType}"
												filterMatchMode="contains" width="20%">
												<h:outputText value="#{notfiItem.fineRoleType}" />

											</p:column>
											<p:column style="white-space: nowrap;text-align: center;"
												headerText="#{msg['status']}" width="20%">
												<h:outputText
													value="#{notfiItem.complete == 1? 'مستوفى':'غير مستوفى'}  -  #{notfiItem.urgent == 1? 'حرج':'غير حرج'}" />
											</p:column>
											<p:column style="white-space: nowrap;text-align: center;"
												headerText=" عدد تكرار المخالفة" width="20%">
												<h:outputText
													value="#{notfiItem.duplicated == 0 ? 'غير مكرر': notfiItem.duplicated }" />
												<!-- 													== 1? 'مكرر':'غير مكرر' -->
											</p:column>
											<p:column style="white-space: nowrap;text-align: center;"
												headerText="حد العقوبة" width="20%">
												<h:outputText
													value="#{notfiItem.upDown == 0? 'حد ادني':'حد اعلى'}" />
											</p:column>
											<p:column style="white-space: nowrap;text-align: center;"
												headerText="الشرح" width="40%">
												<h:inputTextarea disabled="true" style="opacity;1"
													value="#{notfiItem.observation}" />
											</p:column>

										</p:dataTable>
									</div>

								</p:fieldset>
								<div class="image-box-footer" align="left">
									<p:commandButton value="رجوع" immediate="true"
										icon="ui-icon-arrow" styleClass="deep-orange-btn"
										onclick="PF('details_dlg').hide()" />
								</div>
							</h:panelGroup>
						</p:dialog>


						<!-- 						<p:dialog widgetVar="confirmdlg" width="30%" -->
						<!-- 							header="هل أنت متأكد من الحذف ؟" hideEffect="fade" -->
						<!-- 							showEffect="explode" dir="rtl" modal="true" resizable="false"> -->
						<!-- 							<p:commandButton value="نعم" styleClass="btn btn-primary" -->
						<!-- 								style="float:left;" update="includeform:myDialog" -->
						<!-- 								onsuccess="PF('confirmdlg').hide();" -->
						<!-- 								action="#{notifPenalitiesBean.deleteSelDetails}" /> -->
						<!-- 							<p:spacer /> -->
						<!-- 							<p:commandButton value="لا" styleClass="btn btn-primary" -->
						<!-- 								style="float:left;" update="includeform:myDialog" -->
						<!-- 								onsuccess="PF('confirmdlg').hide();" /> -->
						<!-- 						</p:dialog> -->
						<!-- 						<p:dialog widgetVar="confirmdlg1" width="30%" -->
						<!-- 							header="هل أنت متأكد من تسجيل المخالفة؟" hideEffect="fade" -->
						<!-- 							showEffect="explode" dir="rtl" modal="true" resizable="false"> -->
						<!-- 							<h:form> -->
						<!-- 								<p:commandButton value="نعم" styleClass="btn btn-primary" -->
						<!-- 									style="float:left;" action="#{notifPenalitiesBean.save}" -->
						<!-- 									onsuccess="PF('confirmdlg1').hide();" -->
						<!-- 									update="includeform:myDialog" /> -->
						<!-- 								<p:spacer /> -->
						<!-- 								<p:commandButton value="لا" styleClass="btn btn-primary" -->
						<!-- 									style="float:left;" update="includeform" -->
						<!-- 									onsuccess="PF('confirmdlg1').hide();" /> -->
						<!-- 							</h:form> -->
						<!-- 						</p:dialog> -->
					</div>
				</h:form>
			</ui:define>
		</ui:composition>

	</h:body>
</f:view>
</html>
