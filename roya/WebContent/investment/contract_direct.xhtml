<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:b="http://bootsfaces.net/ui">
<f:view>

	<!-- 	<h:head> -->
	<!-- 		  <link -->
	<!-- 			href="#{facesContext.externalContext.requestContextPath}/resources/css/style.css" -->
	<!-- 			rel="stylesheet" type="text/css"></link> -->
	<!-- 	</h:head> -->
	<!-- 	<script type="text/javascript">  
	window.onload = window.history.forward(0);
 	</script> -->
	<!-- <style>
.ui-spinner-input {
	vertical-align: middle;
	text-align: right;
	padding-right: 15px;
	width: 90% !important;
}
</style> -->
	<h:body>

		<ui:composition template="/template.xhtml">
			<p:growl autoUpdate="true" showDetail="false" />

			<ui:define name="content">
				<h:form id="includeform">
					<p:messages autoUpdate="true" closable="true"></p:messages>

					<div class="image-box-footer" align="left">
						<p:commandButton value="إضافة" styleClass="cyan-btn"
							icon="ui-icon ui-icon-add" oncomplete=" PF('addDialog').show()"
							action="#{contractDirectBean.addContract}" process="@this"
							update="includeform:addPG">
						</p:commandButton>
					</div>
					<br />

					<div class="card card-w-title" dir="rtl">

						<h1 style="color: #7CB342; text-align: center;">
							العقود المباشرة <span class="fa fa-fw fa-file-text-o"></span>
						</h1>

						<div class="ui-g">
							<div class="ui-g-2">
								<h:outputLabel styleClass="btxt" value="نوع النشاط" />
							</div>
							<div class="ui-g-2">
								<p:selectOneMenu filterMatchMode="contains" filter="true"
									style="width:100%" value="#{contractDirectBean.contractTypeId}">
									<f:selectItem itemLabel="اختر نوع النشاط" />
									<f:selectItems
										value="#{loadingDataBean.contractDirectTypesList}" var="x"
										itemLabel="#{x.name}" itemValue="#{x.id}" />
									<f:ajax render="@form" execute="@this" event="change"
										listener="#{contractDirectBean.loadContracts}" />
								</p:selectOneMenu>
							</div>


						</div>

						<p:dataTable var="userItem" id="allusersettingdt"
							widgetVar="ContractsTable"
							value="#{contractDirectBean.contractsDirectList}"
							emptyMessage="لايوجد بيانات" rowIndexVar="rowIndex"
							paginatorPosition="bottom"
							paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
							filteredValue="#{contractDirectBean.filteredContractsDirectList}"
							paginator="true" rows="17">

							<f:facet name="header">
								<p:outputPanel>
									<h:outputText value="ابحث فى كل الحقول:" />
									<p:inputText id="globalFilter" onkeyup="PF('cellemp').filter()"
										style="width:150px" placeholder="كلمة البحث">
									</p:inputText>
								</p:outputPanel>
							</f:facet>

							<p:column id="idcol" headerText="رقم العقد" sortable="true"
								sortBy="#{userItem.contractNum}"
								filterBy="#{userItem.contractNum}" filterMatchMode="contains"
								width="7%" style="text-align: center;">
                            #{userItem.contractNum}
                        </p:column>
							<p:column headerText="تاريخ بداية العقد"
								style="text-align: center;" filterBy="#{userItem.startContDate}"
								filterMatchMode="contains" width="11%">
								 #{userItem.startContDate}           
                        </p:column>
							<p:column headerText="تاريخ نهاية العقد"
								style="text-align: center;" filterBy="#{userItem.endContDate}"
								filterMatchMode="contains" width="11%">
								#{userItem.endContDate}           
								             </p:column>
							<p:column headerText="المستثمر" width="24%"
								filterBy="#{userItem.investor.name}" filterMatchMode="contains">
                            #{userItem.investor.name}
                        </p:column>
							<p:column headerText="الحالة" width="7%"
								filterBy="#{userItem.contractStatId}" filterMatchMode="exact">
								<f:facet name="filter">
									<p:selectOneMenu onchange="PF('ContractsTable').filter()">
										<f:selectItem itemLabel="إختر" itemValue="#{null}"
											noSelectionOption="true" />
										<f:selectItem itemLabel="جديد" itemValue="1" />
										<f:selectItem itemLabel="تجديد" itemValue="2" />
										<f:selectItem itemLabel="ملغى" itemValue="3" />
									</p:selectOneMenu>
								</f:facet>
                            #{userItem.statusName}
                        </p:column>
							<p:column headerText="الفواتير" width="8%"
								filterBy="#{userItem.payStatus}" filterMatchMode="exact">
								<f:facet name="filter">
									<p:selectOneMenu onchange="PF('ContractsTable').filter()">
										<f:selectItem itemLabel="   إختر" itemValue="#{null}"
											noSelectionOption="true" />
										<f:selectItem itemLabel="غير مسددة" itemValue="0" />
										<f:selectItem itemLabel="مسددة" itemValue="1" />
									</p:selectOneMenu>
								</f:facet>
								<h:outputText value="#{userItem.payStatusName}"
									style="#{(userItem.payStatus == 0) ? 'color:red' : 'color:green'}" />
							</p:column>
							<p:column headerText="المنتهية" width="8%"
								filterBy="#{userItem.finished}" filterMatchMode="exact">
								<f:facet name="filter">
									<p:selectOneMenu onchange="PF('ContractsTable').filter()">
										<f:selectItem itemLabel="إختر" itemValue="#{null}"
											noSelectionOption="true" />
										<f:selectItem itemLabel="غير منتهية" itemValue="0" />
										<f:selectItem itemLabel="منتهية" itemValue="1" />
									</p:selectOneMenu>
								</f:facet>
									#{(userItem.finished == 1)?'منتهية':'غير منتهية'}
								</p:column>
							<p:column style="white-space: nowrap;text-align: center;"
								headerText="التفاصيل" width="6%">
								<p:commandButton oncomplete="PF('addDialog').show();"
									action="#{contractDirectBean.loadContract}" process="@this"
									icon="ui-icon-search" update="includeform:addPG">
									<f:setPropertyActionListener value="#{userItem}"
										target="#{contractDirectBean.contractDirect}" />
								</p:commandButton>
							</p:column>
							<!-- 								<p:column width="7%" style="text-align:center" -->
							<!-- 									headerText="#{msg['delete']}"> -->
							<!-- 									<p:commandButton id="delete" immediate="true" -->
							<!-- 										icon="ui-icon-trash" update="@form" -->
							<!-- 										action="#{contractDirectBean.deleteContract}"> -->
							<!-- 										<f:setPropertyActionListener value="#{userItem}" -->
							<!-- 											target="#{contractDirectBean.contractDirect}" /> -->
							<!-- 									</p:commandButton> -->

							<!-- 								</p:column> -->
							<p:column width="13%" style="text-align:center"
								headerText="العملية">
								<p:selectOneMenu style="width:50%" id="operation_choice"
									value="#{userItem.operationId}">
									<f:selectItem itemLabel="العملية" itemValue="0" />
									<f:selectItems value="#{userItem.actionsList}" var="x"
										itemLabel="#{x.name}" itemValue="#{x.action}" />
								</p:selectOneMenu>
								<p:spacer width="5" />
								<p:commandButton icon="fa fa-mail-reply" update="@form" process="@this,operation_choice"
									action="#{contractDirectBean.doAction}">
									<f:setPropertyActionListener value="#{userItem}"
										target="#{contractDirectBean.contractDirect}" />
								</p:commandButton>

							</p:column>
							<p:column width="5%" style="text-align:center" headerText="طباعة">
								<p:commandButton ajax="false" icon="ui-icon-print"
									onclick="this.form.target='_blank'" immediate="true"
									action="#{contractDirectBean.printContractReport}">
									<f:setPropertyActionListener value="#{userItem}"
										target="#{contractDirectBean.contractDirect}" />
								</p:commandButton>
								<!-- 									<h:commandButton styleClass="btn btn-primary" -->
								<!-- 										action="#{contractDirectBean.printContractReport}" -->
								<!-- 										rendered="#{!contractDirectBean.addMode}" -->
								<!-- 										onclick="this.form.target='_blank'" value="طباعة"> -->
								<!-- 										<f:setPropertyActionListener value="#{userItem}" -->
								<!-- 											target="#{contractDirectBean.contract}" /> -->
								<!-- 									</h:commandButton> -->
							</p:column>
						</p:dataTable>


						<p:dialog widgetVar="addDialog" width="70%" header="" modal="true"
							dir="rtl" closable="true">
							<h:panelGroup id="addPG">
								<h3 style="color: #7CB342; text-align: center;">إضافة عقد
									مباشر</h3>
								<div class="ui-g">
									<div class="ui-g-12 ui-md-6 ui-lg-3">
										<h:outputLabel value="هجري  :  " />
										<p:selectBooleanCheckbox
											value="#{contractDirectBean.higriMode}">
											<p:ajax update="pDates1,pDates12,pDates3,pDates4" process="@this"></p:ajax>
										</p:selectBooleanCheckbox>
									</div>
								</div>
								<div class="ui-g">
									<div class="ui-g-2">
										<p:outputLabel value="رقم العقد" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:inputText
											value="#{contractDirectBean.contractDirect.contractNum}"
											required="true" requiredMessage="رقم العقد مطلوب"
											rendered="#{contractDirectBean.addMode}" style="width: 100%" />
										<p:outputLabel
											value="#{contractDirectBean.contractDirect.contractNum}"
											rendered="#{!contractDirectBean.addMode}" />
									</div>
									<div class="ui-g-2">
										<p:outputLabel value="تاريخ بداية العقد" styleClass="btxt" />
									</div>
									<!-- 									<div class="ui-g-2"> -->
									<!--  <h:panelGroup id="stratContr" -->
									<!--  rendered="#{contractDirectBean.addMode}"> -->
									<!--  <ui:include src="../shared/calender.xhtml" /> -->
									<!--  </h:panelGroup> -->
									<!--  <p:outputLabel -->
									<!--  value="#{contractDirectBean.contractDirect.startDate}" -->
									<!--  rendered="#{!contractDirectBean.addMode}" /> -->


									<!-- 										<p:calendar id="start_date" pattern="dd/MM/yyyy" locale="ar" -->
									<!-- 											required="true" requiredMessage="تاريخ بداية العقد مطلوب" -->
									<!-- 											value="#{contractDirectBean.selecteStartDate}"> -->
									<!-- 										</p:calendar> -->

									<!-- 									</div> -->

									<div class="ui-g-2">
										<h:panelGroup id="pDates1">
											<p:inputText id="hiri1"
												value="#{contractDirectBean.selecteStartDate}"
												onfocus="loadCalendar();" required="true"
												requiredMessage="يرجى اختيار تاريخ بداية العقد"
												rendered="#{contractDirectBean.higriMode}"
												styleClass="form-control form-controlCal">
											</p:inputText>

											<p:calendar id="gric1"
												value="#{contractDirectBean.selecteStartDate_G}"
												pattern="dd/MM/yyyy"
												rendered="#{!contractDirectBean.higriMode}">
											</p:calendar>
										</h:panelGroup>
									</div>


									<div class="ui-g-2">
										<p:outputLabel value="تاريخ نهاية العقد" styleClass="btxt" />
									</div>
									<!-- 									<div class="ui-g-2"> -->
									<!--  <h:panelGroup id="endContr" -->
									<!--    rendered="#{contractDirectBean.addMode}"> -->
									<!-- <ui:include src="../shared/NotifDate.xhtml" /> -->
									<!--  </h:panelGroup> -->
									<!--  <p:outputLabel -->
									<!--  value="#{contractDirectBean.contractDirect.endDate}" -->
									<!--  rendered="#{!contractDirectBean.addMode}" /> -->

									<!-- 										<p:calendar id="End_date" pattern="dd/MM/yyyy" locale="ar" -->
									<!-- 											required="true" requiredMessage="تاريخ نهاية العقد مطلوب" -->
									<!-- 											value="#{contractDirectBean.selecteEndDate}"> -->
									<!-- 										</p:calendar> -->

									<!-- 									</div> -->
									<div class="ui-g-2">
										<h:panelGroup id="pDates12">
											<p:inputText id="hiri12"
												value="#{contractDirectBean.selecteEndDate}"
												onfocus="loadCalendar();" required="true"
												requiredMessage="يرجى اختيار تاريخ بداية العقد"
												rendered="#{contractDirectBean.higriMode}"
												styleClass="form-control form-controlCal">
											</p:inputText>

											<p:calendar id="gric12"
												value="#{contractDirectBean.selecteEndDate_G}"
												pattern="dd/MM/yyyy"
												rendered="#{!contractDirectBean.higriMode}">
											</p:calendar>
										</h:panelGroup>
									</div>
								</div>
								<div class="ui-g">

									<div class="ui-g-2">
										<p:outputLabel value="التصنيف الرئيسي" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:selectOneMenu id="contract_maincatg_id" required="true"
											requiredMessage="التصنيف الرئيسي مطلوب"
											value="#{contractDirectBean.contractDirect.contractMaincatgId}">
											<f:selectItem itemLabel="إختر التصنيف الرئيسي" itemValue="" />
											<f:selectItems
												value="#{contractDirectBean.contractMainCategoryList}"
												var="maincatg" itemLabel="#{maincatg.name}"
												itemValue="#{maincatg.id}" />
										</p:selectOneMenu>
<!-- 										<p:outputLabel -->
<!-- 											value="#{contractDirectBean.contractDirect.contractMainCategory.name}" -->
<!-- 											rendered="#{!contractDirectBean.addMode}" /> -->
									</div>
									<div class="ui-g-2">
										<p:outputLabel value="التصنيف الفرعي" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:selectOneMenu id="contract_subcatg_id" required="true" 
											requiredMessage="التصنيف الفرعي مطلوب"
											value="#{contractDirectBean.contractDirect.contractSubcatgId}">
											<f:selectItem itemLabel="إختر التصنيف الفرعي" itemValue="" />
											<f:selectItems
												value="#{contractDirectBean.contractSubcategoryList}"
												var="subcatg" itemLabel="#{subcatg.name}"
												itemValue="#{subcatg.id}" />
										</p:selectOneMenu>
<!-- 										<p:outputLabel -->
<!-- 											value="#{contractDirectBean.contractDirect.contractSubcategory.name}" -->
<!-- 											rendered="#{!contractDirectBean.addMode}" /> -->
									</div>

									<div class="ui-g-2">
										<p:outputLabel value="حالة العقد" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:selectOneMenu id="contract_stat_id" required="true"
											requiredMessage="حالة العقد مطلوب"
											value="#{contractDirectBean.contractDirect.contractStatId}">
											<f:selectItem itemLabel="إختر حالة العقد" itemValue="" />
											<f:selectItems
												value="#{contractDirectBean.contractStatusList}" var="stat"
												itemLabel="#{stat.name}" itemValue="#{stat.id}" />
										</p:selectOneMenu>
									</div>
								</div>
								<div class="ui-g">
									<div class="ui-g-2">
										<p:outputLabel value="العقار" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:selectOneMenu filterMatchMode="contains" filter="true"
											required="true" requiredMessage="العقار مطلوب"
											style="width:100%" rendered="#{contractDirectBean.addMode}"
											value="#{contractDirectBean.contractDirect.realEstateId}">
											<f:selectItem itemLabel="اختر العقار" />
											<f:selectItems value="#{loadingDataBean.realEstateList}"
												var="x" itemLabel="#{x.fullName}" itemValue="#{x.id}" />
										</p:selectOneMenu>
										<p:outputLabel
											value="#{contractDirectBean.contractDirect.realEstate.fullName}"
											rendered="#{!contractDirectBean.addMode}" />
									</div>

									<div class="ui-g-2">
										<p:outputLabel value="المستثمر" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:selectOneMenu id="investors_list" filter="true"
											filterMatchMode="contains" required="true"
											requiredMessage="المستثمر مطلوب"
											value="#{contractDirectBean.contractDirect.investorId}"
											style="width: 100%" rendered="#{contractDirectBean.addMode}">
											<f:selectItem itemLabel="أختر المستثمر" itemValue="" />
											<f:selectItems var="tit" itemValue="#{tit.id}"
												itemLabel="#{tit.name}"
												value="#{loadingDataBean.investorsList}" />
											<p:ajax event="change" update="inv_panel " process="@this"
												listener="#{contractDirectBean.loadInvestor}" />
										</p:selectOneMenu>
										<p:outputLabel
											value="#{contractDirectBean.contractDirect.investor.name}"
											rendered="#{!contractDirectBean.addMode}" />
									</div>
								</div>
								<h:panelGroup id="inv_panel">
									<div class="ui-g">
										<div class="ui-g-2">
											<p:outputLabel value="يمثله" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
											<p:inputText
												value="#{contractDirectBean.contractDirect.invRepresentName}"
												rendered="#{contractDirectBean.addMode}" style="width: 100%" />
											<p:outputLabel
												value="#{contractDirectBean.contractDirect.invRepresentName}"
												rendered="#{!contractDirectBean.addMode}" />
										</div>
										<div class="ui-g-2">
											<p:outputLabel value="صفته" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
											<p:inputText
												value="#{contractDirectBean.contractDirect.invRepresentFunct}"
												rendered="#{contractDirectBean.addMode}" style="width: 100%" />
											<p:outputLabel
												value="#{contractDirectBean.contractDirect.invRepresentFunct}"
												rendered="#{!contractDirectBean.addMode}" />
										</div>
									</div>
									<div class="ui-g">
										<div class="ui-g-2">
											<p:outputLabel value="رقم الهوية" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
											<p:inputText
												value="#{contractDirectBean.contractDirect.invRepresentNatId}"
												rendered="#{contractDirectBean.addMode}" style="width: 100%" />
											<p:outputLabel
												value="#{contractDirectBean.contractDirect.invRepresentNatId}"
												rendered="#{!contractDirectBean.addMode}" />
										</div>
										<div class="ui-g-2">
											<p:outputLabel value="صادرة من" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
											<p:inputText
												value="#{contractDirectBean.contractDirect.invRepresentIdPlace}"
												rendered="#{contractDirectBean.addMode}" style="width: 100%" />
											<p:outputLabel
												value="#{contractDirectBean.contractDirect.invRepresentIdPlace}"
												rendered="#{!contractDirectBean.addMode}" />
										</div>
										<div class="ui-g-2">
											<p:outputLabel value="بتاريخ" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
											<p:inputMask rendered="#{contractDirectBean.addMode}"
												value="#{contractDirectBean.contractDirect.invRepresentIdDate}"
												mask="99/99/9999"
												style="font-size: large !important; width: 100% !important;" />
											<p:outputLabel
												value="#{contractDirectBean.contractDirect.invRepresentIdDate}"
												rendered="#{!contractDirectBean.addMode}" />
										</div>
									</div>
								</h:panelGroup>
								<div class="ui-g">
									<div class="ui-g-2">
										<p:outputLabel value="الإيجار السنوي (ريال)" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:inputText id="annualRent" required="true"
											requiredMessage="الإيجار السنوي مطلوب"
											value="#{contractDirectBean.contractDirect.annualRent}"
											style="width: 90%">
											<p:ajax event="blur" update="proc_period" process="@this"
												listener="#{contractDirectBean.calculateProcessPeriod}" />
											<!-- process="@this,stratContr,endContr" -->
										</p:inputText>
<!-- 										<p:outputLabel -->
<!-- 											value="#{contractDirectBean.contractDirect.annualRent}" -->
<!-- 											rendered="#{!contractDirectBean.addMode}" /> -->
<!-- 										<p:outputLabel value="" /> -->
									</div>
									<div class="ui-g-2">
										<p:outputLabel value="مدة التجهيز و الإنشاء (يوم)"
											styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:inputText id="proc_period" required="true"
											requiredMessage="مدة التجهيز مطلوبة"
											value="#{contractDirectBean.contractDirect.processPeriod}"
											rendered="#{contractDirectBean.addMode}" style="width: 100%" />
										<p:inputText
											value="#{contractDirectBean.contractDirect.processPeriod}"
											rendered="#{!contractDirectBean.addMode}" />
									</div>
								</div>
								<div class="ui-g">
										<div class="ui-g-2">
											<p:outputLabel value="تاريخ بداية فترة الفاتورة" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
											<h:panelGroup id="pDates4">
											<p:inputText id="hiri4"
												value="#{contractDirectBean.contractDirect.billStartDate}"
												onfocus="loadCalendar();" required="true"
												requiredMessage="يرجى اختيار تاريخ بداية العقد"
												rendered="#{contractDirectBean.higriMode}"
												styleClass="form-control form-controlCal">
											</p:inputText>

											<p:calendar id="gric41"
												value="#{contractDirectBean.contractDirect.billGStartDate}"
												pattern="dd/MM/yyyy"
												rendered="#{!contractDirectBean.higriMode}">
											</p:calendar>
										</h:panelGroup>
										</div>
										<div class="ui-g-2">
											<p:outputLabel value="تاريخ نهاية الفترة الفاتورة" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
<!-- 											<p:inputMask mask="99/99/9999" value="#{contractDirectBean.contractDirect.billEndDate}" /> -->
										<h:panelGroup id="pDates3">
											<p:inputText id="hiri3"
												value="#{contractDirectBean.contractDirect.billEndDate}"
												onfocus="loadCalendar();" required="true"
												requiredMessage="يرجى اختيار تاريخ بداية العقد"
												rendered="#{contractDirectBean.higriMode}"
												styleClass="form-control form-controlCal">
											</p:inputText>

											<p:calendar id="gric32"
												value="#{contractDirectBean.contractDirect.billGEndDate}"
												pattern="dd/MM/yyyy"
												rendered="#{!contractDirectBean.higriMode}">
											</p:calendar>
										</h:panelGroup>
										</div>
									</div>
								<div class="ui-g">
									<div class="ui-g-2">
										<p:outputLabel value="مقدمة العقد" styleClass="btxt"
											rendered="#{contractDirectBean.addMode}" />
									</div>
									<div class="ui-g-2">
										<p:selectOneMenu filterMatchMode="contains" filter="true"
											style="width:50%" rendered="#{contractDirectBean.addMode}"
											value="#{contractDirectBean.introductionId}">
											<f:selectItem itemLabel="اختر المقدمة" />
											<f:selectItems value="#{loadingDataBean.introContractList}"
												var="x" itemLabel="#{x.name}" itemValue="#{x.id}" />
											<p:ajax event="change" update="intro_contract"
												process="@this"
												listener="#{contractDirectBean.loadIntroduction}" />
										</p:selectOneMenu>
									</div>
								</div>
								<div class="ui-g">
									<div class="ui-g-2">
										<p:outputLabel value="مقدمة العقد" styleClass="btxt"
											rendered="#{!contractDirectBean.addMode}" />
									</div>
									<div class="ui-g-2">
										<p:inputTextarea id="intro_contract" rows="6" cols="150"
											required="true" requiredMessage="مقدمة العقد مطلوبة"
											value="#{contractDirectBean.contractDirect.introduction}"
											rendered="#{contractDirectBean.addMode}" />
										<p:inputTextarea id="intro_contract_update" rows="6"
											cols="150"
											value="#{contractDirectBean.contractDirect.introduction}"
											rendered="#{!contractDirectBean.addMode}" />
									</div>
								</div>
								<p:messages id="messages" autoUpdate="true" />
								<div class="image-box-footer" align="left">
									<p:commandButton value="حفظ" update="@form"
										rendered="#{contractDirectBean.addMode}"
										action="#{contractDirectBean.save}"
										onsuccess="PF('addDialog').hide();">
									</p:commandButton>
									<p:spacer width="10px" height="10px"></p:spacer>
									<p:commandButton value="تعديل" update="@form"
										rendered="#{!contractDirectBean.addMode}"
										action="#{contractDirectBean.update}"
										onsuccess="PF('addDialog').hide();">
										<!--   action="#{contractDirectBean.updateContractBill}" -->

									</p:commandButton>
									<p:spacer width="10px" height="10px"></p:spacer>
									<p:commandButton value="رجوع" immediate="true"
										onsuccess="PF('addDialog').hide();" />
								</div>
							</h:panelGroup>
						</p:dialog>
						<p:dialog widgetVar="cancelDialog" width="70%" header="عقد مباشر"
							modal="true" dir="rtl" closable="true">
							<h:panelGroup id="addPG1">
								<div class="ui-g">
									<div class="ui-g-2">
										<p:outputLabel value="رقم العقد" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:outputLabel
											value="#{contractDirectBean.contractDirect.contractNum}" />
									</div>
									<div class="ui-g-2">
										<p:outputLabel value="تاريخ بداية العقد" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:outputLabel
											value="#{contractDirectBean.contractDirect.startDate}" />
									</div>
									<div class="ui-g-2">
										<p:outputLabel value="تاريخ نهاية العقد" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:outputLabel
											value="#{contractDirectBean.contractDirect.endDate}" />
									</div>
								</div>
								<div class="ui-g">
									<div class="ui-g-2">
										<p:outputLabel value="العقار" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:outputLabel
											value="#{contractDirectBean.contractDirect.realEstate.fullName}" />
									</div>
								</div>
								<div class="ui-g">
									<div class="ui-g-2">
										<p:outputLabel value="المستثمر" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:outputLabel
											value="#{contractDirectBean.contractDirect.investor.name}" />
									</div>
								</div>

								<div class="ui-g">
									<div class="ui-g-2">
										<p:outputLabel value="الإيجار السنوي (ريال)" styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:outputLabel
											value="#{contractDirectBean.contractDirect.annualRent}" />
									</div>
									<div class="ui-g-3">
										<p:outputLabel value="مدة التجهيز و الإنشاء (يوم)"
											styleClass="btxt" />
									</div>
									<div class="ui-g-2">
										<p:outputLabel
											value="#{contractDirectBean.contractDirect.processPeriod}" />
									</div>
								</div>

								<h:panelGroup rendered="#{!contractDirectBean.addBill}">

									<div class="ui-g">
										<div class="ui-g-2">
											<p:outputLabel value="سبب الإلغاء" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
											<p:selectOneMenu filterMatchMode="contains" filter="true"
												style="width:50%"
												value="#{contractDirectBean.contractDirect.cancelReasonId}">
												<f:selectItem itemLabel="اختر السبب" />
												<f:selectItems value="#{loadingDataBean.reasonsList}"
													var="x" itemLabel="#{x.name}" itemValue="#{x.id}" />
											</p:selectOneMenu>
										</div>
									</div>


									<div class="ui-g">
										<div class="ui-g-2">
											<p:outputLabel value="ملاحظات" styleClass="btxt" />
										</div>
										<div class="ui-g-10">
											<p:inputTextarea rows="6" cols="60"
												value="#{contractDirectBean.contractDirect.observation}" />
										</div>
									</div>

								</h:panelGroup>
								<h:panelGroup id="bill_PG"
									rendered="#{contractDirectBean.addBill}">

									<div class="ui-g">
										<div class="ui-g-2">
											<p:outputLabel value="الفواتير السابقة" styleClass="btxt" />
										</div>
										<div class="ui-g-10">
											<p:dataTable var="billItem" widgetVar="billsTable"
												value="#{contractDirectBean.contractBillsList}"
												emptyMessage="لايوجد بيانات" rowIndexVar="rowBIndex"
												paginatorPosition="bottom"
												paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
												paginator="true" rows="5">

												<p:column headerText="رقم الفاتورة" width="8%"
													style="text-align: center;">
						                            #{billItem.billNumber}
						                        </p:column>
												<p:column headerText="المبلغ" width="8%"
													style="text-align: center;">
						                            #{billItem.payAmount}
						                        </p:column>
												<p:column headerText="تاريخ بداية الفترة"
													style="text-align: center;" width="13%">
						                            #{billItem.payDateFrom}
						                        </p:column>
												<p:column headerText="تاريخ نهاية الفترة"
													style="text-align: center;" width="13%">
						                            #{billItem.payDateTo}
						                        </p:column>
												<p:column headerText="الحالة" style="text-align: center;"
													width="13%">
						                            #{billItem.sadadStatus}
						                        </p:column>
											</p:dataTable>
										</div>
									</div>


									<div class="ui-g">
										<div class="ui-g-2">
											<p:outputLabel value="رقم الفاتورة" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
											<p:inputText value="#{contractDirectBean.numBill}">
												<p:ajax event="blur" update="bill_PG" process="@this"
													listener="#{contractDirectBean.loadBill}">
												</p:ajax>
											</p:inputText>
										</div>
										<div class="ui-g-2">
											<p:outputLabel value="المبلغ" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
											<p:outputLabel value="#{contractDirectBean.bill.payAmount}" />
										</div>
									</div>

									<div class="ui-g">
										<div class="ui-g-2">
											<p:outputLabel value="تاريخ بداية الفترة" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
											<p:inputText value="#{contractDirectBean.bill.payDateFrom}" />
										</div>
										<div class="ui-g-2">
											<p:outputLabel value="تاريخ نهاية الفترة" styleClass="btxt" />
										</div>
										<div class="ui-g-2">
											<p:inputText value="#{contractDirectBean.bill.payDateTo}" />
										</div>
									</div>

								</h:panelGroup>
								<p:messages id="messages1" autoUpdate="true" />
								<div class="image-box-footer" align="left">
									<p:commandButton value="حفظ" update="@form"
										action="#{contractDirectBean.update}"
										rendered="#{!contractDirectBean.addBill}"
										onsuccess="PF('cancelDialog').hide();">
									</p:commandButton>
									<p:commandButton value="ربط الفاتورة" update="@form"
										action="#{contractDirectBean.updateBill}"
										rendered="#{contractDirectBean.addBill}"
										onsuccess="PF('cancelDialog').hide();">
									</p:commandButton>
									<p:commandButton value="رجوع" immediate="true"
										onsuccess="PF('cancelDialog').hide();" />
								</div>
							</h:panelGroup>
						</p:dialog>
						<p:dialog widgetVar="smsSadad" width="80%" header="سداد فاتورة"
							modal="true" dir="rtl" closable="true">
							<h:panelGroup id="sadad">
								<p:messages id="smsSadad" autoUpdate="true" />
								<!-- 								<h:panelGroup rendered="true"> -->
								<!-- 								<div class="row"> -->
								<!-- 									<div class="ui-g-2"> -->
								<!-- 										<p:outputLabel value="السنوات" styleClass="btxt" /> -->
								<!-- 									</div> -->
								<!-- 									<div class="ui-g-1"> -->
								<!-- 										<p:spinner id="basic" -->
								<!-- 											value="#{contractDirectBean.contractBills.years}" max="20" -->
								<!-- 											min="1" /> -->
								<!-- 									</div> -->
								<!-- 									<div class="ui-g-1"> -->
								<!-- 										<p:outputLabel value="البند" styleClass="btxt" /> -->
								<!-- 									</div> -->
								<!-- 									<div class="ui-g-2"> -->
								<!-- 										<p:selectOneMenu id="itemsList" filter="true" -->
								<!-- 											style="white-space: pre;" filterMatchMode="contains" -->
								<!-- 											value="#{contractDirectBean.selectedItemId}"> -->
								<!-- 											<f:selectItem itemLabel="أختر من البنود" itemValue="" /> -->
								<!-- 											<f:selectItems value="#{contractDirectBean.itemsList}" -->
								<!-- 												var="categ" -->
								<!-- 												itemLabel="#{categ.accountNumber} - #{categ.name}" -->
								<!-- 												itemValue="#{categ.accountNumber}" /> -->
								<!-- 										</p:selectOneMenu> -->
								<!-- 									</div> -->
								<!-- 								</div> -->
								<!-- 								<br /> -->
								<!-- 							</h:panelGroup> -->
								<br />
								<div class="image-box-footer" align="left">
									<p:commandButton value="حفظ" update="@form"
										action="#{contractDirectBean.updateContractBill}"
										onsuccess="PF('cancelDialog').hide();">
									</p:commandButton>
									<p:commandButton value="رجوع" immediate="true"
										onsuccess="PF('cancelDialog').hide();" />
								</div>
							</h:panelGroup>
						</p:dialog>
						<!-- 					<p:dialog widgetVar="smsSadad" width="80%" -->
						<!-- 						header="سداد فاتورة" modal="true" dir="rtl" closable="true"> -->
						<!-- 						<h:panelGroup id="sadad"> -->
						<!-- 							<p:messages id="smsSadad" autoUpdate="true" /> -->

						<!-- 								<h:panelGroup rendered="true"> -->
						<!-- 								<div class="row"> -->
						<!-- 									<div class="ui-g-2"> -->
						<!-- 										<p:outputLabel value="السنوات" styleClass="btxt" /> -->
						<!-- 									</div> -->
						<!-- 									<div class="ui-g-1"> -->
						<!-- 										<p:spinner id="basic" -->
						<!-- 											value="#{contractDirectBean.contractBills.years}" max="20" -->
						<!-- 											min="1" /> -->
						<!-- 									</div> -->
						<!-- 									<div class="ui-g-1"> -->
						<!-- 										<p:outputLabel value="البند" styleClass="btxt" /> -->
						<!-- 									</div> -->
						<!-- 									<div class="ui-g-2"> -->
						<!-- 										<p:selectOneMenu id="itemsList" filter="true" -->
						<!-- 											style="white-space: pre;" filterMatchMode="contains" -->
						<!-- 											value="#{contractDirectBean.selectedItemId}"> -->
						<!-- 											<f:selectItem itemLabel="أختر من البنود" itemValue="" /> -->
						<!-- 											<f:selectItems value="#{contractDirectBean.itemsList}" -->
						<!-- 												var="categ" -->
						<!-- 												itemLabel="#{categ.accountNumber} - #{categ.name}" -->
						<!-- 												itemValue="#{categ.accountNumber}" /> -->
						<!-- 										</p:selectOneMenu> -->
						<!-- 									</div> -->
						<!-- 								</div> -->
						<!-- 								<br /> -->
						<!-- 							</h:panelGroup> -->
						<!-- 							<br /> -->
						<!-- 										<div class="image-box-footer" align="left">
 -->
						<!-- 								<p:commandButton value="حفظ" styleClass="btn btn-primary" -->
						<!-- 									update="@form" action="#{contractDirectBean.updateContractBill}" -->
						<!-- 									style="margin-left:3px;" onsuccess="PF('cancelDialog').hide();"> -->
						<!-- 								</p:commandButton> -->
						<!-- 								<p:commandButton value="رجوع" styleClass="btn btn-primary" -->
						<!-- 									immediate="true" onsuccess="PF('cancelDialog').hide();" /> -->
						<!-- 							</div> -->
						<!-- 						</h:panelGroup> -->
						<!-- 					</p:dialog> -->
					</div>

				</h:form>
			</ui:define>
		</ui:composition>
	</h:body>
</f:view>
</html>
