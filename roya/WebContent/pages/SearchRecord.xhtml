
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
	<h:outputStylesheet name="./css/default.css" />
	<h:outputStylesheet name="./css/cssLayout.css" />
	<h:outputStylesheet name="./css/style.css" />
</h:head>
<h:body>



	<ui:composition template="./WebTemplate.xhtml">

		<ui:define name="top">
 				#{msg['search.in.transactions']}
            </ui:define>

		<ui:define name="content">
			<h:form id="form001" style="margin-top: 0px !important;">
				<p:growl autoUpdate="true" />
				<p:tabView id="tview">
					<p:tab id="tab001" title="#{msg['with.num.transaction']}">
						<div class="container-fluid">
							<div class="row" style="margin: 5px;">
								<div class="col-md-4">
									<p:outputLabel style="margin: 7px;"
										value="#{msg['enter.transaction.speech.subject']}" />
								</div>
								<div class="col-md-8">
									<p:inputText id="tt001" style=" font-size: larger; width: 60%"
										value="#{searchBean.arcNo}" />
									<p:commandButton update=":tempform:form001:rec_dt"
										process="@this,tt001" action="#{searchBean.SrchBtn(ae)}"
										value="#{msg['search']}" icon="fa fa-search" />
								</div>
							</div>
						</div>
					</p:tab>
					<p:tab id="tab003" title="#{msg['in.speach']}">
						<div class="container-fluid">
							<div class="row" style="margin: 5px;">
								<div class="col-md-4">
									<p:outputLabel style="margin: 7px;"
										value="#{msg['enter.key.search']}" />
								</div>
								<div class="col-md-8">
									<p:inputText id="tt002" style=" font-size: larger; width: 60%"
										value="#{searchBean.srchKey}" />
									<p:commandButton update=":tempform:form001:rec_dt"
										process="@this,tt002"
										action="#{searchBean.SrchCommentBtn(ae)}"
										value="#{msg['search']}" />
								</div>
							</div>
						</div>
					</p:tab>
					<p:tab id="tab004" title="#{msg['in.explanations']}">
						<div class="container-fluid">
							<div class="row"></div>
						</div>
					</p:tab>
					<p:tab id="tab005" title="#{msg['senders.receivers']}">
						<div class="container-fluid">
							<div class="row" style="margin: 5px;">
								<div class="col-md-5">
									<p:outputLabel value="#{msg['transactions.sender']}" />
									<p:selectOneMenu style="width: 60%" filter="true"
										filterMatchMode="contains"
										value="#{searchBean.selectedLetterfrom}">
										<f:selectItem itemLabel="#{msg['choose.sender']}" />
										<f:selectItems value="#{searchBean.letterFromMap}" />
										<p:ajax event="change"
											listener="#{searchBean.changeLetterFromList(changeEvent)}"
											process="@this" update=":tempform:form001:rec_dt" />
									</p:selectOneMenu>
								</div>
								<div class="col-md-5">
									<h:outputLabel value="#{msg['transactions.receiver']}" />
									<p:selectOneMenu style="width: 70%" filter="true"
										filterMatchMode="contains"
										value="#{searchBean.selectedLetterTo}">
										<f:selectItem itemLabel="#{msg['choose.receiver']}" />
										<f:selectItems value="#{searchBean.letterToMap}" />
										<p:ajax event="change"
											listener="#{searchBean.changeLetterToList(changeEvent)}"
											process="@this" update=":tempform:form001:rec_dt" />
									</p:selectOneMenu>
								</div>
								<div class="col-md-2">
									<p:commandButton value="#{msg['search']}" />
								</div>
							</div>
						</div>
					</p:tab>
				</p:tabView>

				<p:dataTable var="arc" id="rec_dt" value="#{searchBean.findList()}"
					lazy="true" rowKey="#{arc.arcId}"
					style="margin-top: 3px;font-size: small !important;"
					emptyMessage="#{msg['empty.list']}" scrollRows="20"
					scrollable="true" liveScroll="true" scrollHeight="370">
					<p:column width="5%">
						<p:rowToggler />
					</p:column>
					<p:column headerText="#{msg['num.transaction']}" width="10%">
						<p:outputLabel value="#{arc.incomeNo}"
							style="font-size: small !important;" />
					</p:column>
					<p:column headerText="#{msg['subject.transaction']}" width="25%">
						<p:outputLabel value="#{arc.recTitle}"
							style="font-size: small !important;" />
					</p:column>
					<p:column headerText="#{msg['sender.transaction']}" width="20%">
						<p:outputLabel value="#{arc.letterFrom}"
							style="font-size: small !important;" />
					</p:column>
					<p:column headerText="#{msg['receiver.transaction']}" width="20%">
						<p:outputLabel value="#{arc.letterTo}"
							style="font-size: small !important;" />
					</p:column>
					<p:column headerText="#{msg['date.receiver']}" width="15%">
						<p:outputLabel value="#{arc.incomeHDate}"
							style="font-size: small !important;" />
					</p:column>
					<p:column>
                                #{arc.lastEmpName}
                            </p:column>
					<p:column style="text-align: center" width="7%">
						<p:commandButton
							action="#{searchBean.clickrowAction(actionEvent)}"
							oncomplete="PF('recordDlg').show()" process="@this"
							update="
                                                  :tempform:form001:recordDlgid,
                                                  :tempform:form001:dlgform:tab006:AttachmantTab
                                                  "
							icon="ui-icon-search" title="View">
							<f:setPropertyActionListener value="#{arc}"
								target="#{searchBean.selectedArc}" />
						</p:commandButton>
					</p:column>
					<p:rowExpansion>

						<div class="container-fluid">
							<div class="row">
								<div class="col-md-4">
									<p:outputLabel value="الموظف المتوقف عنده المعاملة" />
								</div>
								<div class="col-md-8">
									<p:outputLabel value="#{arc.lastRecord.lastEmployeeName}" />
								</div>
							</div>
							<div class="row">
								<div class="col-md-4">
									<p:outputLabel value="الموظف مصدر الحركة" />
								</div>
								<div class="col-md-8">
									<p:outputLabel value="#{arc.lastRecord.lastFromEmployeeName}" />
								</div>
							</div>
							<div class="row">
								<div class="col-md-4">
									<p:outputLabel value="سبب الحالة" />
								</div>
								<div class="col-md-8">
									<p:outputLabel value="#{arc.lastRecord.lastdirection}" />
								</div>
							</div>

							<div class="row">
								<div class="col-md-4">
									<p:outputLabel value="تاريخ آخر حركة " />
								</div>
								<div class="col-md-8">
									<p:outputLabel
										value="#{arc.lastRecord.lastWrkDate} &nbsp;&nbsp; من &nbsp; #{arc.lastRecord.lastWrkdurationindays}&nbsp;&nbsp; يوم " />

								</div>
							</div>

							<div class="row">
								<div class="col-md-4">
									<p:outputLabel value=" نص الخطاب  " />
								</div>
								<div class="col-md-8">
									<p:outputLabel value="#{arc.lastRecord.commentText} " />

								</div>
							</div>

						</div>
					</p:rowExpansion>
				</p:dataTable>

				<p:dialog widgetVar="recordDlg" id="recordDlgid" width="700"
					height="500" modal="true" showEffect="fade"
					header=" #{searchBean.selectedArc.recTitle}" resizable="false">
					<h:form id="dlgform">


						<p:tabView id="tab006">
							<p:tab title="الشروحات">
								<object type="application/pdf"
									data="#{searchBean.currentRecordExplainLink}" height="400px"
									width="100%">
									ميزة الأستعراض غير مدعمة للمتصفح <a href="#">أضغط هنا </a>
									لتحميل الملف .
								</object>
							</p:tab>
							<p:tab title="المرفقات">

								<p:tabView value="#{searchBean.attList}" var="att"
									id="AttachmantTab">
									<p:tab title="مرفق - #{att.attId}">
										<h:form target="_blank">
											<p:row>
                                                    قام بارفاقه    #{att.ownerName}  <a
													href="#{att.attLink}" target="_blank">أضغط هنا </a> لتحميل الملف .
                                                </p:row>
											<object type="application/pdf" data="#{att.attLink}"
												height="300px" width="100%">
												ميزة الأستعراض غير مدعمة للمتصفح <a href="#{att.attLink}">أضغط
													هنا </a> لتحميل الملف .
											</object>
										</h:form>
									</p:tab>
								</p:tabView>
							</p:tab>
							<p:tab title="الاجراءات">

								<h:form id="selectform" style="margin-top: 20px;">
									<p:outputLabel for="console" value="أختر الاجراء المطلوب "
										style="padding: 5px;" />
									<p:selectOneRadio id="console"
										value="#{searchBean.selectAction}" layout="grid" columns="1">
										<f:selectItem itemLabel="نقل اجراءات المعاملة  " itemValue="A" />
										<f:selectItem itemLabel="إرسال نسخة من شروحات المعاملة "
											itemValue="B" />
										<f:selectItem itemLabel="إرسال نسخة من خطاب المعاملة "
											itemValue="C" id="rad001" rendered="#{searchBean.hasComment}" />
										<p:ajax
											listener="#{searchBean.selectradioComment(valueChangeEvent)}"
											update="console" event="valueChange" />
									</p:selectOneRadio>

									<div class="container-fluid">
										<div class="row" style="font-size: large; margin-top: 10px;">
											<div class="col-md-2"
												style="font-size: large; margin-top: 5px;">
												<p:outputLabel value="أختر الموظف " />
											</div>
											<div class="col-md-7">
												<p:selectOneMenu style="width: 100%" filter="true"
													filterMatchMode="contains"
													value="#{searchBean.selectedEmployee}" id="empList">
													<f:selectItem itemLabel="اختر الموظف المطلوب" />
													<f:selectItems value="#{searchBean.allUsersMap}" />>
                                                    </p:selectOneMenu>

											</div>
											<div class="col-md-3">
												<p:commandButton value="إرسال "
													update=":tempform:form001:rec_dt"
													process="@this,console,empList"
													action="#{searchBean.sendRecordAction(actionEvent)}"
													style="width: 100%;" />

											</div>
										</div>
										<div class="row">
											<p:messages autoUpdate="true" />
										</div>
										<div class="row" style="color: red;">*سيتم تضمين اشعار
											تحريك المعاملة كجزء من الشروحات</div>
									</div>
								</h:form>

							</p:tab>
						</p:tabView>

					</h:form>

				</p:dialog>

			</h:form>
			<p:ajaxStatus>
				<f:facet name="start">
					<img src="../images/loading.gif" />
				</f:facet>
			</p:ajaxStatus>
		</ui:define>

	</ui:composition>

</h:body>
</html>
