<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <body>


        <ui:composition template="./WebTemplate.xhtml">
            <ui:define name="top">
                #{msg['param.charging']}
            </ui:define>
            <ui:define name="content">
                <p:outputLabel value="tesyttttt"></p:outputLabel>
                <h:form id="chargingpageId">
                    <div class="container-fluid">
                        <div class="row" style="padding: 5px;">

                            <div class="col-md-4"></div>
                            <div class="col-md-4" >
                                <p:commandButton value="#{msg['add.charging']}" 
                                                 onclick ="PF('NewChargdialog').show();"
                                                 icon="fa fa-plus" style="width: 100% " />
                            </div>
                            <div class="col-md-4"></div>
                        </div>
                        <div class="row">
                            <p:dataTable
                                var="charg"
                                value="#{chargingBean.chargingList}"
                                emptyMessage="#{msg['empty.charging']}"
                                >
                                <p:column headerText="#{msg['charged.employer']}">
                                    #{charg.whoIsChargedName}
                                </p:column>
                                <p:column headerText="#{msg['leaved.employer']}">
                                    #{charg.whoIsNotHereName}
                                </p:column>
                                <p:column headerText="#{msg['begin.charging']}">

                                    #{charg.convStartDate}
                                </p:column>
                                <p:column headerText="#{msg['end.charging']}">
                                    #{charg.convEndDate}
                                </p:column>

                                <p:column headerText="#{msg['validity.charging']}">
                                    #{charg.privilageAfterName}
                                </p:column>
                                <p:column>
                                    <p:commandButton value="#{msg['finish.charging']}" icon="fa fa-close" />
                                </p:column>
                            </p:dataTable>
                        </div>
                    </div>
                    <p:dialog widgetVar="NewChargdialog"
                              width="500" 
                              id="newChargDlg"
                              resizable="false"
                              header="تكليف جديد" modal="true" style="direction: rtl;">
                        <h:form id="chargingformId">
                            <div class="container-fluid">
                                <div class="row">
                                    <p:panelGrid id="chargingGridId" columns="2">
                                        <p:outputLabel value="#{msg['charged.employer']}" />
                                        <p:selectOneMenu 
                                            filter="true"
                                            filterMatchMode="contains"
                                            required="true"
                                            requiredMessage="#{msg['required.charged.employer']}"
                                            id="whoischargedid"
                                            style="width: 100%;" value="#{chargingBean.whoIscharged}" >
                                            <f:selectItem itemLabel="#{msg['choose.charged.employer']}" itemValue="" />
                                            <f:selectItems value="#{chargingBean.allUserList}" />
                                        </p:selectOneMenu>
                                        <p:outputLabel value="#{msg['leaved.employer']}" />
                                        <p:selectOneMenu 

                                            filter="true"
                                            filterMatchMode="contains"
                                            required="true"
                                            requiredMessage="#{msg['required.leaved.employer']}"
                                            id="whoisNotHereid"
                                            style="width: 100%" value="#{chargingBean.whoIsNotHere}" >
                                            <p:ajax event="change" update=":tempform:chargingpageId:chargingformId:chargingNameId" listener="#{chargingBean.whoIsNotHereListChanged}" />
                                            <f:selectItem itemLabel="#{msg['choose.leaved.employer']}" itemValue="" />
                                            <f:selectItems value="#{chargingBean.allUserList}" />
                                        </p:selectOneMenu>
                                        <p:outputLabel value="#{msg['charging.name']}" />
                                        <p:inputText 
                                            required="true"
                                            requiredMessage="#{msg['required.charging.name']}"
                                            placeholder="#{msg['employer.name.charging']}"
                                            id="chargingNameId"
                                            style="width: 100%" value="#{chargingBean.chargingName}" />
                                        <p:outputLabel value="#{msg['begin.charging']}" />
                                        <p:inputText 
                                            required="true"
                                            requiredMessage="#{msg['required.begin.charging']}"
                                            placeholder="#{msg['begin.charging']}"
                                            id="chargingstartdateId"
                                            style="width: 100%" value="#{chargingBean.chargingStartDate}" />
                                        <p:outputLabel value="#{msg['end.charging']}" />
                                        <p:inputText 
                                            required="true"
                                            requiredMessage="#{msg['required.end.charging']}"
                                            placeholder="#{msg['end.charging']}"
                                            id="chargingEndDateId"
                                            style="width: 100%" value="#{chargingBean.chargingEndDate}" />
                                        <p:outputLabel value="#{msg['validity.charging']}" />
                                        <p:selectOneMenu 
                                            required="true"
                                            requiredMessage="#{msg['required.validity.charging']}"
                                            id="chargingprivilageId"
                                            style="width: 300px" value="#{chargingBean.chargingPrivilage}" >
                                            <f:selectItem itemLabel="#{msg['choose.validity.charging']}" itemValue="" />
                                            <f:selectItems value="#{chargingBean.allUserRoles}" />
                                        </p:selectOneMenu>

                                    </p:panelGrid>
                                    <p:messages autoUpdate="true" />
                                </div>



                                <div class="row">
                                    <div class="col-md-4"></div>
                                    <div class="col-md-4">
                                        <p:commandButton value="#{msg['save']}" 
                                                         action="#{chargingBean.CreateChargingBtn(actionEvent)}"
                                                         icon="fa fa-save" 
                                                         update="
                                                         :tempform:chargingpageId:chargingformId:whoischargedid,
                                                         :tempform:chargingpageId:chargingformId:whoisNotHereid,
                                                         :tempform:chargingpageId:chargingformId:chargingNameId,
                                                         :tempform:chargingpageId:chargingformId:chargingstartdateId,
                                                         :tempform:chargingpageId:chargingformId:chargingEndDateId,
                                                         :tempform:chargingpageId:chargingformId:chargingprivilageId"                                                        
                                                         process="@this,
                                                         :tempform:chargingpageId:chargingformId:whoischargedid,
                                                         :tempform:chargingpageId:chargingformId:whoisNotHereid,
                                                         :tempform:chargingpageId:chargingformId:chargingNameId,
                                                         :tempform:chargingpageId:chargingformId:chargingstartdateId,
                                                         :tempform:chargingpageId:chargingformId:chargingEndDateId,
                                                         :tempform:chargingpageId:chargingformId:chargingprivilageId"
                                                         style="width: 100%" />
                                    </div>
                                    <div class="col-md-4">

                                    </div>
                                </div>

                            </div>
                        </h:form>
                    </p:dialog>


                </h:form>
            </ui:define>
        </ui:composition>

    </body>
</html>
