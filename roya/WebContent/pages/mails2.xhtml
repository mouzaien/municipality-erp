<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core">


<h:head>


	<script type="text/javascript"
		src="#{facesContext.externalContext.requestContextPath}/datatableCss4/js/jquery.dataTables.min.js"></script>

	<script type="text/javascript"
		src="#{facesContext.externalContext.requestContextPath}/datatableCss4/js/dataTables.bootstrap.min.js"></script>

	<link href="Css/style.css" rel="stylesheet" type="text/css"></link>
	<link href="../resources/css/purecss/pure-min.css" rel="stylesheet"
		type="text/css"></link>







	<link rel="stylesheet" type="text/css"
		href="#{facesContext.externalContext.requestContextPath}/resources/css/bootstrap-arabic.css" />
	<link rel="stylesheet" type="text/css"
		href="#{facesContext.externalContext.requestContextPath}/resources/css/style.css" />
	<link type="text/css" rel="stylesheet"
		href="/project/faces/javax.faces.resource/theme.css?ln=primefaces-south-street" />


	<style>
</style>



	
	<script>
function outBox(){
	var x =document.getElementsByClassName("outBoxLoadBTN");
	x[0].click();

	

}

function onLoadFunction(){
var x=document.getElementsByClassName("propertyId");

if(x[0].value=='outBox'){
var z= document.getElementsByClassName("outboxx");
var c= document.getElementsByClassName("outBoxLoadBTN");
z[0].click();
c[0].click();
}
else {
	var t= document.getElementsByClassName("inbox");
	t[0].click();	
}
}

</script>


</h:head>

<h:body onload="onLoadFunction()">
	<h:form id="includeform">
	
	
<script>
$(document).ready(function() {
		$('#myTable').dataTable({
			"columnDefs": [
			               {
			                   "targets": [ 3 ],
			                   "visible": false,
			                   "searchable": true
			               }
			           ],
			"autoWidth": true,
            
            "oLanguage": {
            	"sSearch": "البحث: ",
                "sLengthMenu": "عدد الأسطر _MENU_ ",
                "sInfo": "عرض _START_ إلى _END_ من مجموع _TOTAL_ بيانات",
                "sInfoEmpty": 'إلى 0 عرض _END_ من مجموع _TOTAL_ بيانات',
                "sZeroRecords": "لاتوجد بيانات للعرض حاليا",
                "sEmptyTable": "لاتوجد بيانات للعرض حاليا",
                "sInfoFiltered": "",
                "sProcessing": "",
                "oPaginate": {
                    "sPrevious": "السابق",
                    "sNext": "التالي"
                }
            },
            "aLengthMenu": [[  25, 50, 100, 200], [25, 50, 100, 200]]

        }
				
		);
		
		

		

	});


</script>		
	
		<h:inputText id="propertyId" styleClass="propertyId"
			value="#{mailsBean.comeFrom}" style="display:none" />

		<p:growl autoUpdate="true" id="growMsg" showDetail="false" />

		<div class="panel-body" style="padding: 0px !important">

			<!-- Nav tabs -->
			<ul class="nav nav-tabs">
				<li><a href="#inbox" class="inbox" data-toggle="tab">
						البريد الوارد</a></li>
				<li id="outBoxItem"><a href="#out" id="outbox" class="outboxx"
					data-toggle="tab" onclick="outBox()">البريد الصادر</a></li>



			</ul>

			<!-- Tab panes -->

			<h:commandButton value="loadOutBox" styleClass="outBoxLoadBTN"
				id="outBoxLoadBTN" style="display:none">

				<f:ajax render="outboxTable" listener="#{mailsBean.loadOutBox}"></f:ajax>
			</h:commandButton>
			<div class="tab-content">

				<div class="tab-pane fade in active" id="inbox">
					<br></br>
					<div class="col-md-4"
						style="font-family: kufi !important; margin-right: -22px;">
						<div class="dropdown ">
							<button class=" dropdown-toggle"
								style="border: none !important; font-family: kufi !important; background-color: transparent !important; font-size: large"
								id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true"
								aria-expanded="true">
								عرض البريد بواسطة <span class="caret"></span>
							</button>
							<ul class="dropdown-menu">
								<li><p:commandLink update="inboxTable description"
										process="@form" actionListener="#{mailsBean.showAllMails}">
										<span class="glyphicon glyphicon-file"></span>
									  الكل </p:commandLink></li>
								<li><p:commandLink update="inboxTable description"
										process="@form" actionListener="#{mailsBean.showUnReadMails}">
										<span class="glyphicon glyphicon-user"></span>
									  البريد الغير مقروء  </p:commandLink></li>

								<li><p:commandLink update="inboxTable description"
										process="@form" action="#{mailsBean.showReadMails}">
										<span class="glyphicon glyphicon-user"></span>
									  البريد المقروء  </p:commandLink></li>

								<li><p:commandLink process="@this"
										update="inboxTable description"
										actionListener="#{mailsBean.showTodayMails}">
										<span class="glyphicon glyphicon-file"></span>
									   بريد اليوم </p:commandLink></li>
								<li><p:commandLink process="@this"
										update="inboxTable description"
										actionListener="#{mailsBean.showImportantMails}">
										<span class="glyphicon glyphicon-file"></span>
									   (البريد الهام (العاجل)</p:commandLink></li>


							</ul>
						</div>

					</div>


					<div class="col-md-4"
						style="font-family: kufi !important; margin-right: -22px;">
						<div class="dropdown ">
							<button class=" dropdown-toggle"
								style="border: none !important; font-family: kufi !important; background-color: transparent !important; font-size: large"
								id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true"
								aria-expanded="true">
								عرض البريد بالمجلدات <span class="caret"></span>
							</button>
							<ul class="dropdown-menu">
								<ui:repeat var="folder" value="#{mailsBean.userfolders}">
									<li><p:commandLink update=" @form" process="@form"
											actionListener="#{mailsBean.showMailsByFolder(folder.folderId,folder.folderName)}">
											<span class="glyphicon glyphicon-file"></span>
								#{folder.folderName}	   </p:commandLink></li>

								</ui:repeat>

							</ul>
						</div>

					</div>
		
					<p:commandButton style="float:left" icon=" fa fa-refresh">
						
						<f:ajax render="@form" execute="@this" listener="#{mailsBean.refreshMails}"></f:ajax></p:commandButton>
					<h:commandButton styleClass="btn btn-primary"
						style="float:left;margin-bottom: 8px;margin-left:3px"
						value="أرشفة المعاملة">
						<f:ajax execute="@form" render="inboxTable"
							listener="#{mailsBean.sendRecordListToArchive}"></f:ajax>
					</h:commandButton>
					<br></br> <br></br>
					<div class="col-lg-12"
						style="background-color: white; border-top: 5px solid #428BCA">
						<br></br>
						<div class="text-center">
							<h:panelGroup id="description">
								<h:outputText style="color:#428BCA ;font-size: large"
									rendered="#{mailsBean.folderFlag}" value="#{mailsBean.folderName}"> ( #{mailsBean.todayCount} )</h:outputText>
								<h:outputText style="color:#428BCA ;font-size: large"
									rendered="#{mailsBean.readMailsFlag}" value=" البريد المقروء ">( #{mailsBean.readInboxCount} )</h:outputText>
								<h:outputText style="color:#428BCA ;font-size: large"
									rendered="#{mailsBean.unReadMailsFlag}"
									value="البريد    الغير   المقروء"> ( #{mailsBean.unreadInboxCount} )</h:outputText>
								<h:outputText style="color:#428BCA ;font-size: large"
									rendered="#{mailsBean.todayMailsFlag}" value="البريد اليوم"> ( #{mailsBean.todayCount} )</h:outputText>
								<h:outputText style="color:#428BCA ;font-size: large"
									rendered="#{mailsBean.importantMailFlag}" value="البريد الهام"> ( #{mailsBean.importantMailCount} )</h:outputText>
							</h:panelGroup>
						</div>


						<br></br>
						<h:panelGroup id="inboxTable">
				
							
							<table id="myTable"
								class="table table-striped table-bordered dt-responsive  table-hover">
								<thead style="background: #428bca; color: white">
									<tr>

										<th style="width: 5%">رقم</th>
										<th style="width: 25%">المُرسل</th>
										<th style="width: 45%">الموضوع</th>
										<th style="width: 5%"></th>
										<th style="width: 5%">الوارد</th>
										<th style="width: 5%">عرض</th>
										<th style="width: 5%">تحديد</th>
										<th style="width: 5%">الحالة</th>

									</tr>
								</thead>

								<tbody>

									<ui:repeat varStatus="x" value="#{mailsBean.inboxList}"
										var="inboxitem">


										<tr style="color: #{inboxitem.wrkColor== 1?'red ':' '} ">

											<td>#{x.index+1}</td>
											<td>#{inboxitem.wrkSender} <br />
												#{inboxitem.convWrkCreateTime} |#{inboxitem.convWrkHdate} |
												<div class="fa fa-paperclip" style="color: #B9B9B9" />
												#{inboxitem.convWrkAttachCount} |
												<div class="fa fa-comment" style="color: #B9B9B9" />
												#{inboxitem.convWrkTotalSteps}
											</td>
											<td>
												<div id="read-icon" class="fa  fa-check"
													style="font-size: 14px; color: #B9B9B9; display: #{inboxitem.isRead== 1? '':'none'}" />

												<p:commandLink value="#{inboxitem.appTitle}"
													action="#{mailsBean.viewInboxRow(inboxitem)}"
													icon="ui-icon-search" process="@this">
												</p:commandLink>

											</td>
											<td>#{inboxitem.wrkIncomeNo}</td>
											<td>#{inboxitem.convWrkIncomeNo}</td>
											<!-- 											<td><h:commandButton id="xx" -->
											<!-- 													styleClass="btn btn-success" value="عرض" -->
											<!-- 													action="#{inboxBean.viewInboxRow(action)}"> -->

											<!-- 													<f:setPropertyActionListener value="#{inboxitem}" -->
											<!-- 														target="#{inboxBean.selectedInbox}" /> -->
											<!-- 													<f:ajax execute="@form"> -->
											<!-- 													</f:ajax> -->
											<!-- 												</h:commandButton></td> -->

											<td><p:commandButton
													action="#{mailsBean.viewInboxRow(inboxitem)}"
													icon="ui-icon-search" process="@this">
												</p:commandButton></td>
											<td><h:selectBooleanCheckbox
													value="#{inboxitem.checked}">
													<f:ajax listener="#{mailsBean.checkRecord(inboxitem)}"
														execute="@form" render="inboxTable"></f:ajax>
												</h:selectBooleanCheckbox></td>
											<td><h:panelGroup
													rendered="#{inboxitem.wrkColor==1?'true':'false'}">
													<h:outputLabel style="color:red" value="عاجل"></h:outputLabel>
												</h:panelGroup></td>

										</tr>

									</ui:repeat>

								</tbody>

							</table>

						</h:panelGroup>

					</div>


				</div>






				<div class="tab-pane fade" id="out">
					<br></br>
					<div class="row">

						<div class="col-md-3">
							<p:inputText id="year" requiredMessage="ادخل السنة   " 
								validatorMessage="ادخل السنة بطريقة صحيحة"
								placeholder="ادخل السنة المراد عرض الصادر  فيها "
								value="#{mailsBean.yearOfSearch}">
								<f:validateRegex pattern="^\d{4}$"></f:validateRegex>
							</p:inputText>
						</div>
						<div class="col-md-2" >
							<h:selectOneMenu id="xss"  value="#{mailsBean.yearMonths}">
								<f:selectItem itemValue="1" itemLabel="الربع الاول من السنة" />
								<f:selectItem itemValue="2" itemLabel="الربع الثانى  من السنة" />
								<f:selectItem itemValue="3" itemLabel="الربع الثالث من السنة" />
								<f:selectItem itemValue="4" itemLabel="الربع الاخير من السنة" />

							</h:selectOneMenu>
						</div>
						<div class="col-md-3">
							<h:commandButton styleClass="btn btn-success btn-sm" value="عرض">

								<f:ajax execute="year xss" listener="#{mailsBean.outBoxMailsSearch}"
									render="outboxTable"></f:ajax>
							</h:commandButton>
						</div>
					</div>
					<br></br> <br></br>
					<div class="col-lg-12"
						style="background-color: white; border-top: 5px solid #428BCA">
						<br></br> <br></br>
						<h:panelGroup id="outboxTable">
	<script>
 
$(document).ready(function() {
		$('#myTable2').dataTable({
			"columnDefs": [
			               {
			                   "targets": [ 3 ],
			                   "visible": false,
			                   "searchable": true
			               }
			           ],
            "oLanguage": {
            	"sSearch": "البحث: ",
                "sLengthMenu": "عدد الأسطر _MENU_ ",
                "sInfo": "عرض _START_ إلى _END_ من مجموع _TOTAL_ بيانات",
                "sInfoEmpty": 'إلى 0 عرض _END_ من مجموع _TOTAL_ بيانات',
                "sZeroRecords": "لاتوجد بيانات للعرض حاليا",
                "sEmptyTable": "لاتوجد بيانات للعرض حاليا",
                "sInfoFiltered": "",
                "sProcessing": "",
                "oPaginate": {
                    "sPrevious": "السابق",
                                        "sNext": "التالي"
                }
            },
            "aLengthMenu": [[25, 50, 100, 200], [ 25, 50, 100, 200]]

        }
				
		);
	});


</script>
 		
							<table id="myTable2"
								class="table table-striped table-bordered dt-responsive nowrap table-hover"
								width="100%">

								<thead style="background: #428bca; color: white">
									<tr>
										<th style="width: 5%">رقم</th>
										<th style="width: 25%">المُرسل إليه</th>
										<th style="width: 45%">الموضوع</th>
										<th style="width: 10%"></th>
										<th style="width: 10%">الوارد</th>
										<th style="width: 10%">الغرض</th>
										<th style="width: 5%">عرض</th>
									</tr>
								</thead>
								<tbody>
									<ui:repeat varStatus="det" value="#{mailsBean.outBoxList}"
										var="outboxitem">
										<tr>

											<td>#{det.index+1}</td>
											<td>#{outboxitem.wrkReciever} <br />
												#{outboxitem.convWrkCreateTime} |#{outboxitem.convWrkHdate}
												|
												<div class="fa fa-paperclip" style="color: #B9B9B9" />
												#{outboxitem.convWrkAttachCount} |
												<div class="fa fa-comment" style="color: #B9B9B9" />
												#{outboxitem.convWrkTotalSteps}
											</td>
											<td>#{outboxitem.appTitle}</td>
											<td>#{outboxitem.wrkIncomeNo}</td>
											<td>#{outboxitem.convWrkIncomeNo}</td>
											<td>#{outboxitem.purpose}</td>

											<td><p:commandButton icon="ui-icon-search"
													process="@this"
													action="#{mailsBean.viewOutBoxRow(outboxitem)}" /></td>
										</tr>
									</ui:repeat>
								</tbody>
							</table>
						</h:panelGroup>

					</div>






				</div>




			</div>


		</div>





		<br></br>

	</h:form>

</h:body>
</html>
