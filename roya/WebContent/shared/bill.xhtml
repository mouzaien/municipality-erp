<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core">
<f:view>


	<!-- 	<h:head> -->

	<!-- 		<link -->
	<!-- 			href="#{facesContext.externalContext.requestContextPath}/resources/css/style.css" -->
	<!-- 			rel="stylesheet" type="text/css"></link> -->
	<!-- 	</h:head> -->
	<script type="text/javascript">
		window.onload = window.history.forward(0);
	</script>
	<h:body>

		<ui:composition template="/template.xhtml">
			<ui:define name="content">
				<h:form id="includeform">
					<p:messages autoUpdate="true" closable="true"></p:messages>

					<div class="image-box-footer" align="left">
						<p:commandButton value="#{msg['back']}" action="search_bill"
							immediate="true"  styleClass="orange-btn">
							<f:ajax execute="@form"></f:ajax>
						</p:commandButton>
						<p:spacer width="10px" height="10px"></p:spacer>
						<p:commandButton value="طباعة" immediate="true" ajax="false"
							icon="ui-icon ui-icon-print" onclick="this.form.target='_blank'"
							styleClass="purple-btn" action="#{billBean.printBillReport}">
						</p:commandButton>
						<p:spacer width="10px" height="10px"></p:spacer>
						<p:commandButton value="#{msg['save']}"
							rendered="#{!billBean.consultMode}" styleClass="green-btn"
							 immediate="true"
							actionListener="#{billBean.saveBillAction}">
							<f:ajax execute="@form" render="@form"></f:ajax>
						</p:commandButton>
						<p:spacer width="10px" height="10px"></p:spacer>

						<p:commandButton value="#{msg['change.bill']}"
							rendered="#{billBean.consultMode}" styleClass="btn btn-primary"
							action="#{billBean.changeBillAction}">
							<f:ajax execute="@form" render="@form"></f:ajax>
						</p:commandButton>
					</div>
					<br />
					<div class="card card-w-title" dir="rtl">
						<h1 style="color: #7CB342; text-align: center;">
							#{msg['bills']}</h1>
						<h3 style="text-align: right;">#{msg['bill.data']}</h3>
						<h:panelGroup rendered="#{billBean.consultMode}">
							<div class="ui-g">
								<div class="ui-g-2">
									<h:outputLabel value="#{msg['bill.number']}" styleClass="btxt" />
								</div>
								<div class="ui-g-3">
									<h:outputLabel value="#{billBean.payLicBill.billNumber}" />
								</div>
							</div>
						</h:panelGroup>
						<div class="ui-g">
							<div class="ui-g-2">
								<h:outputLabel value="#{msg['category']}" styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:selectOneMenu id="categoryList"
									disabled="#{billBean.consultMode}"
									value="#{billBean.payLicBill.licenceType}"
									style="width:100%; dir:rtl;">
									<f:selectItems value="#{loadingDataBean.billCategoriesList}"
										var="categ" itemLabel="#{categ.label}"
										itemValue="#{categ.code}" />
								</p:selectOneMenu>
							</div>
						</div>
						<div class="ui-g">
							<div class="ui-g-2">
								<h:outputLabel value="#{msg['bill.owner.name']}"
									styleClass="btxt" />
							</div>
							<div class="ui-g-5">
								<p:inputText value="#{billBean.payLicBill.billOwnerName}"
									style="width:100%;" disabled="#{billBean.consultMode}"
									styleClass="form-control" />
							</div>
						</div>
						<div class="ui-g">
							<div class="ui-g-2">
								<h:outputLabel value="#{msg['bill.owner.phone']}"
									styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:inputText value="#{billBean.payLicBill.payInstallNumber}"
									converterMessage="#{msg['error.phone.number']}" required="true"
									requiredMessage="رقم الجوال مطلوب"
									disabled="#{billBean.consultMode}" styleClass="form-control">
									<f:validator validatorId="utilities.PhoneNumberValidator" />
								</p:inputText>
							</div>
						</div>

						<div class="ui-g">
							<div class="ui-g-2">
								<h:outputLabel value="رقم السجل" styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:inputText value="#{billBean.payLicBill.aplOwner}"
									converterMessage="#{msg['error.NationalId']}" required="true"
									requiredMessage="رقم السجل مطلوب"
									disabled="#{billBean.consultMode}" styleClass="form-control">
									<f:validator validatorId="nationalIdValidator" />
								</p:inputText>
							</div>
						</div>

						<h:panelGroup rendered="#{!billBean.consultMode}">
							<div class="ui-g">
								<div class="ui-g-2">
									<h:outputLabel value="#{msg['item.name']}"
										rendered="#{!billBean.consultMode}" styleClass="btxt" />
								</div>
								<div class="ui-g-3">
									<p:selectOneMenu id="itemsList" filter="true" required="true"
										requiredMessage="ادخل البند مطلوب" filterMatchMode="contains"
										rendered="#{!billBean.consultMode}"
										value="#{billBean.selectedItemId}">
										<f:selectItem itemLabel="أختر من البنود" itemValue=""
											noSelectionOption="true" />
										<f:selectItems value="#{billBean.itemsList}" var="categ"
											itemLabel="#{categ.accountNumber} - #{categ.name}"
											itemValue="#{categ.accountNumber}" />
									</p:selectOneMenu>
								</div>
							</div>
							<div class="ui-g">
								<div class="ui-g-2" />
								<div class="ui-g-1">
									<p:inputNumber value="#{billBean.amount}" placeholder="المبلغ"
										rendered="#{!billBean.consultMode}" size="5"
										styleClass="form-control" />
								</div>
								<div class="ui-g-3">
									<p:commandButton value="#{msg['add']}"
										rendered="#{!billBean.consultMode}" icon="fa fa-paperclip"
										styleClass="btn btn-primary">

										<f:ajax execute="@form" render="@form"
											listener="#{billBean.addNewItem}" />
									</p:commandButton>
								</div>
							</div>
						</h:panelGroup>
						<br />
						<p:dataTable id="itemsTable" var="item"
							value="#{billBean.detailsBillList}" widgetVar="loanVar"
							emptyMessage="لايوجد بيانات" rowIndexVar="rowIndex"
							paginatorPosition="bottom"
							paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
							paginator="true" rows="17">
							<f:facet name="header">
								<p:outputPanel>
									<h:outputText value="ابحث فى كل الحقول:" />
									<p:inputText id="globalFilter" onkeyup="PF('cellemp').filter()"
										style="width:150px" placeholder="كلمة البحث">
									</p:inputText>
								</p:outputPanel>
							</f:facet>
							<p:column id="number" headerText="#{msg['item.number']}"
								filterBy="#{item.payDetails}" filterMatchMode="contains"
								width="20%" style="text-align: center;">
								<h:outputText value="#{item.payDetails}" />
							</p:column>
							<p:column id="Label" headerText="#{msg['item.name']}"
								filterBy="#{item.itemLabel}" filterMatchMode="contains"
								width="50%" style="text-align: center;">
								<h:outputText value="#{item.itemLabel}"></h:outputText>
							</p:column>
							<p:column id="amount" headerText="#{msg['amount']}"
								filterBy="#{item.amount}" filterMatchMode="contains" width="20%"
								style="text-align: center;">
								<h:outputText value="#{item.amount}">
									<f:convertNumber pattern="#0.00" />
								</h:outputText>
							</p:column>
							<p:column id="delete_item" headerText="حذف" width="10%"
								style="text-align: center;">
								<p:commandButton id="delete" value="#{msg['delete']}"
									icon="fa fa-paperclip" rendered="#{!billBean.consultMode}"
									styleClass="btn btn-primary">

									<f:setPropertyActionListener value="#{item}"
										target="#{billBean.selectedItem}" />
									<f:ajax execute="delete" render="@form"></f:ajax>
								</p:commandButton>
							</p:column>
						</p:dataTable>




						<!-- 						<div class="ui-g" align="center"> -->
						<!-- 							<div class="ui-g-2"></div> -->
						<!-- 							<div class="ui-g-8"> -->



						<!-- 								<div class="table-responsive"> -->
						<!-- 									<table id="itemsTB" -->
						<!-- 										class="table table-striped table-bordered table-hover"> -->
						<!-- 										<thead> -->
						<!-- 											<tr> -->
						<!-- 												<th width="20%" style="text-align: center;">#{msg['item.number']}</th> -->
						<!-- 												<th width="50%" style="text-align: center;">#{msg['item.name']}</th> -->
						<!-- 												<th width="20%" style="text-align: center;">#{msg['amount']}</th> -->
						<!-- 												<th width="10%"></th> -->
						<!-- 											</tr> -->
						<!-- 										</thead> -->
						<!-- 										<tbody> -->
						<!-- 											<ui:repeat var="item" value="#{billBean.detailsBillList}"> -->
						<!-- 												<tr> -->
						<!-- 													<td style="text-align: center;"><h:outputText -->
						<!-- 															value="#{item.payDetails}" /></td> -->
						<!-- 													<td>#{item.itemLabel}</td> -->
						<!-- 													<td style="text-align: center;"><h:outputText -->
						<!-- 															value="#{item.amount}"> -->
						<!-- 															<f:convertNumber pattern="#0.00" /> -->
						<!-- 														</h:outputText></td> -->
						<!-- 													<td style="text-align: center;"><p:commandButton -->
						<!-- 															id="delete" value="#{msg['delete']}" -->
						<!-- 															icon="fa fa-paperclip" -->
						<!-- 															rendered="#{!billBean.consultMode}" -->
						<!-- 															styleClass="btn btn-primary"> -->

						<!-- 															<f:setPropertyActionListener value="#{item}" -->
						<!-- 																target="#{billBean.selectedItem}" /> -->
						<!-- 															<f:ajax execute="delete" render="@form"></f:ajax> -->
						<!-- 														</p:commandButton></td> -->

						<!-- 												</tr> -->

						<!-- 											</ui:repeat> -->
						<!-- 										</tbody> -->
						<!-- 										<tfoot> -->
						<!-- 											<tr> -->

						<!-- 												<th /> -->
						<!-- 												<th style="text-align: left;">#{msg['total']}</th> -->
						<!-- 												<th style="text-align: center;"><h:outputText -->
						<!-- 														value="#{billBean.totalAmountBill}"> -->
						<!-- 														<f:convertNumber pattern="#0.00" /> -->
						<!-- 													</h:outputText></th> -->
						<!-- 												<th /> -->
						<!-- 											</tr> -->
						<!-- 										</tfoot> -->
						<!-- 									</table> -->
						<!-- 								</div> -->
						<!-- 							</div> -->
						<!-- 						</div> -->
						<!--  <div class="container-fluid"> -->

						<!--  </div> -->
					</div>
				</h:form>
			</ui:define>
		</ui:composition>

	</h:body>
</f:view>
</html>
