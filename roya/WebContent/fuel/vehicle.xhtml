<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core">
<ui:composition template="/template.xhtml">
	<ui:define name="content">
		<h:form id="includeform">
			<p:messages autoUpdate="true" closable="true"></p:messages>

			<div class="ui-g-4">
				<div class="ui-g-2">
					<p:commandButton ajax="false" value="طباعة" icon="ui-icon-print"
						onclick="this.form.target='_blank'" immediate="true"
						action="#{vehicleBean.printCarsReport}">
					</p:commandButton>
				</div>
				<div class="ui-g-2">
					<p:commandButton value="إضافة" icon="fa fa-plus"
						style="float:left;font-family: kufi !important;"
						action="#{vehicleBean.addCar}" oncomplete="PF('car_dlg').show()"
						update="includeform:addPG ">
					</p:commandButton>
				</div>

			</div>

			<br />
			<br />
			<br />
			<br />

			<h1 style="color: #7CB342; float: unset; text-align: center;">
				المركبات <span class="ui-icon ui-icon-cars"></span>
			</h1>

			<br />
			<br />

			<div class="col-md-12">
				<p:dataTable var="carItem" id="carTable"
					value="#{vehicleBean.carsList}" emptyMessage="لايوجد بيانات"
					rowIndexVar="rowIndex" dir="rtl"
					paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
					filteredValue="#{vehicleBean.filteredCarsList}" paginator="true"
					rows="12">
					<p:column headerText="الرقم" filterBy="#{rowIndex+1}"
						filterMatchMode="contains" style="width:5%;text-align:center;">
						<h:outputText value="#{rowIndex+1}" />
					</p:column>
					<p:column headerText="اسم الصنف" filterBy="#{carItem.artName}"
						filterMatchMode="contains" style="width:20%;text-align:center;">
						<h:outputText value="#{carItem.artName}" />
					</p:column>
					<p:column headerText="رقم اللوحة" filterBy="#{carItem.matricule}"
						filterMatchMode="contains" style="width:15%;text-align:center;">
						<h:outputText value="#{carItem.matricule}" />
					</p:column>
					<p:column headerText="المصنع"
						filterBy="#{carItem.model.brand.name}" filterMatchMode="contains"
						style="width:20%;text-align:center;">
						<h:outputText value="#{carItem.model.brand.name}" />
					</p:column>
					<p:column headerText="المركبة" filterBy="#{carItem.model.name}"
						filterMatchMode="contains" style="width:15%;text-align:center;">
						<h:outputText value="#{carItem.model.name}" />
					</p:column>
					<p:column headerText="رقم الباب" filterBy="#{carItem.numDoor}"
						filterMatchMode="contains" style="width:15%;text-align:center;">
						<h:outputText value="#{carItem.numDoor}" />
					</p:column>
					<p:column headerText="صنف المركبة"
						style="width:13%;text-align:center;"
						filterBy="#{carItem.vehicleType.name}" filterMatchMode="contains">
						<h:outputText value="#{carItem.vehicleType.name}" />
					</p:column>

					<p:column headerText="رقم الهيكل"
						filterBy="#{carItem.chassisNumber}" filterMatchMode="contains"
						style="width:13%;text-align:center;">
						<h:outputText value="#{carItem.chassisNumber}" />
					</p:column>

					<p:column width="7%" style="text-align:center"
						headerText="#{msg['details']}">
						<p:commandButton oncomplete="PF('car_dlg').show();"
							action="#{vehicleBean.loadSelectedCar}" process="@this"
							icon="ui-icon-search" update="includeform:addPG">
							<f:setPropertyActionListener value="#{carItem}"
								target="#{vehicleBean.car}" />
						</p:commandButton>
					</p:column>
					<p:column width="7%" style="text-align:center"
						headerText="#{msg['delete']}">
						<p:commandButton id="delete" immediate="true" icon="ui-icon-trash"
							styleClass="red-btn" update="@form"
							action="#{vehicleBean.deleteCar}">
							<f:setPropertyActionListener value="#{carItem}"
								target="#{vehicleBean.car}" />
						</p:commandButton>
					</p:column>
				</p:dataTable>
			</div>
			<p:dialog widgetVar="car_dlg" id="car_dlgId" width="60%"
				hideEffect="fade" showEffect="explode" dir="rtl" modal="true"
				resizable="false">
				<h:panelGroup id="addPG">
					<p:fieldset width="70%" legend="بيانات المركبة">
						<div class="ui-g">
							<div class="ui-g-2">
								<p:outputLabel value="المركبة*" styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:selectOneMenu id="cars_list" value="#{vehicleBean.car.artId}"
									style="width: 100%" filter="true" filterMatchMode="contains">
									<f:selectItems value="#{vehicleBean.carsArticle}" var="art"
										itemValue="#{art.id}" itemLabel="#{art.name}- #{art.code}" />
								</p:selectOneMenu>
							</div>

							<div class="ui-g-2">
								<p:outputLabel value="المصنع*" styleClass="btxt" />
							</div>
							<div class="ui-g-3">

								<p:selectOneMenu value="#{vehicleBean.carBrandId}"
									required="true" requiredMessage="ادخل المصنع"
									style="width: 100%" filter="true" filterMatchMode="contains">
									<f:selectItem itemLabel="أختر المصنع" itemValue=""
										noSelectionOption="true" />
									<f:selectItems var="cont" itemValue="#{cont.id}"
										itemLabel="#{cont.name}"
										value="#{loadingDataBean.carBrandsList}" />
									<p:ajax event="change" update="includeform:models_list"
										process="@this" listener="#{vehicleBean.loadCarModels}" />
								</p:selectOneMenu>
							</div>
						</div>
						<div class="ui-g">
							<div class="ui-g-2">
								<p:outputLabel value="النوع*" styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:selectOneMenu id="models_list" required="true"
									requiredMessage="ادخل النوع"
									value="#{vehicleBean.car.carModel}" style="width: 100%"
									filter="true" filterMatchMode="contains">
									<!-- 								<f:selectItem itemLabel="أختر نوع المركبة" itemValue="" noSelectionOption="true"  /> -->
									<f:selectItems var="cont" itemValue="#{cont.id}"
										itemLabel="#{cont.name}" value="#{vehicleBean.carModelsList}" />
								</p:selectOneMenu>
							</div>


							<div class="ui-g-2">
								<p:outputLabel value="صنف المركبة" styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:selectOneMenu value="#{vehicleBean.car.vehicleTypeId}"
									style="width: 100%" required="true"
									requiredMessage="ادخل صنف المركبة" filter="true"
									filterMatchMode="contains">
									<!-- 								<f:selectItem itemLabel="أختر صنف المركبة" itemValue="" noSelectionOption="true" /> -->
									<f:selectItems var="cont" itemValue="#{cont.id}"
										itemLabel="#{cont.name}"
										value="#{loadingDataBean.vehicleTypeList}" />
								</p:selectOneMenu>
							</div>
						</div>
						<div class="ui-g">
							<div class="ui-g-2">
								<p:outputLabel value="نوع المحروقات" styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:selectOneMenu value="#{vehicleBean.car.fuelTypeId}"
									style="width: 100%" filter="true" filterMatchMode="contains">
									<!-- 								<f:selectItem itemLabel="أختر نوع المحروقات" itemValue="" noSelectionOption="true" /> -->
									<f:selectItems var="cont" itemValue="#{cont.id}"
										itemLabel="#{cont.name}"
										value="#{loadingDataBean.fuelTypeList}" />
								</p:selectOneMenu>

							</div>

							<div class="ui-g-2">
								<p:outputLabel value="سنة الصنع*" styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:inputText required="true" requiredMessage="ادخل سنة الصنع"
									value="#{vehicleBean.car.yearModel}" type="number"
									style="width: 100%" />

							</div>
						</div>
						<div class="ui-g">
							<div class="ui-g-2">
								<p:outputLabel value="رقم اللوحة *" styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:inputText value="#{vehicleBean.car.matricule}"
									required="true" requiredMessage="ادخل رقم اللوحة"
									style="width: 100%" />
							</div>

							<div class="ui-g-2">
								<p:outputLabel value="رقم الباب" styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:inputText value="#{vehicleBean.car.numDoor}"
									style="width: 100%" />
							</div>
						</div>

						<div class="ui-g">
							<div class="ui-g-2">
								<p:outputLabel value="رقم الهيكل" styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:inputText value="#{vehicleBean.car.chassisNumber}"
									style="width: 100%" />

							</div>
							<div class="ui-g-2">
								<p:outputLabel value="لون المركبة" styleClass="btxt" />
							</div>
							<div class="ui-g-3">
								<p:inputText value="#{vehicleBean.car.carColor}"
									style="width: 100%" />

							</div>
						</div>
						<br />
						<div class="iamge-box-footer" align="left">
							<p:commandButton value="حفظ" styleClass="btn btn-primary"
								update="@form " action="#{vehicleBean.save}"
								style="margin-left:3px;">
							</p:commandButton>
							<p:commandButton value="رجوع" styleClass="btn btn-primary"
								immediate="true" onsuccess="PF('car_dlg').hide();" />
						</div>
					</p:fieldset>
				</h:panelGroup>


			</p:dialog>
		</h:form>
	</ui:define>
</ui:composition>

</html>