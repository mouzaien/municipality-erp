<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <body>

        <ui:composition template="./WebTemplate.xhtml">
            <ui:define name="top">
                اعدادات تكاليف الموظفين
            </ui:define>
            <ui:define name="content">
                
                <h:form id="chargingpageId">
                    <div class="container-fluid">
                        <div class="row" style="padding: 5px;">

                            <div class="col-md-4"></div>
                            <div class="col-md-4" >
                                <p:commandButton value="إضافة تكليف جديد" 
                                                 onclick ="PF('NewChargdialog').show();"
                                                 icon="fa fa-plus" style="width: 100% " />
                            </div>
                            <div class="col-md-4"></div>
                        </div>
                        <div class="row">
                            <p:dataTable
                                var="charg"
                                value="#{chargingBean.chargingList}"
                                emptyMessage="لا يوجد تكاليف حاليا"
                                >
                                <p:column headerText="الموظف المكلف">
                                    #{charg.whoIsChargedName}
                                </p:column>
                                <p:column headerText="الموظف المجاز">
                                    #{charg.whoIsNotHereName}
                                </p:column>
                                <p:column headerText="بداية التكليف">

                                    #{chargingBean.da.convertDateToArabic( charg.startDate)}
                                </p:column>
                                <p:column headerText="نهاية التكليف">
                                    #{chargingBean.da.convertDateToArabic( charg.endDate)}
                                </p:column>

                                <p:column headerText="صلاحية التكليف">
                                    #{charg.privilageAfterName}
                                </p:column>
                                <p:column>
                                    <p:commandButton value="إنهاء التكليف" icon="fa fa-close" />
                                </p:column>
                            </p:dataTable>
                        </div>
                    </div>
                    <p:dialog widgetVar="NewChargdialog"
                              width="500" 
                              id="newChargDlg"
                              resizable="false"
                              header="تكليف جديد" modal="true" style="direction: rtl;">
                        <h:form id="chargingformId">
                            <div class="container-fluid">
                                <div class="row">
                                    <p:panelGrid id="chargingGridId" columns="2">
                                        <p:outputLabel value="الموظف المكلف " />
                                        <p:selectOneMenu 
                                            filter="true"
                                            filterMatchMode="contains"
                                            required="true"
                                            requiredMessage="الموظف المكلف مطلوب"
                                            id="whoischargedid"
                                            style="width: 100%;" value="#{chargingBean.whoIscharged}" >
                                            <f:selectItem itemLabel="أختر الموظف المكلف" itemValue="" />
                                            <f:selectItems value="#{chargingBean.allUserList}" />
                                        </p:selectOneMenu>
                                        <p:outputLabel value="الموظف المجاز" />
                                        <p:selectOneMenu 

                                            filter="true"
                                            filterMatchMode="contains"
                                            required="true"
                                            requiredMessage="الموظف المجاز مطلوب"
                                            id="whoisNotHereid"
                                            style="width: 100%" value="#{chargingBean.whoIsNotHere}" >
                                            <p:ajax event="change" update=":tempform:chargingpageId:chargingformId:chargingNameId" listener="#{chargingBean.whoIsNotHereListChanged}" />
                                            <f:selectItem itemLabel="أختر الموظف المجاز" itemValue="" />
                                            <f:selectItems value="#{chargingBean.allUserList}" />
                                        </p:selectOneMenu>
                                        <p:outputLabel value="مسمي التكليف " />
                                        <p:inputText 
                                            required="true"
                                            requiredMessage="مسمي التكليف مطلوب"
                                            placeholder="مسمي الموظف اثناء التكليف"
                                            id="chargingNameId"
                                            style="width: 100%" value="#{chargingBean.chargingName}" />
                                        <p:outputLabel value="بداية التكليف" />
                                        <p:inputText 
                                            required="true"
                                            requiredMessage="بداية التكليف مطلوبة"
                                            placeholder="بداية التكليف"
                                            id="chargingstartdateId"
                                            style="width: 100%" value="#{chargingBean.chargingStartDate}" />
                                        <p:outputLabel value="نهاية التكليف " />
                                        <p:inputText 
                                            required="true"
                                            requiredMessage="نهاية التكليف مطلوبة"
                                            placeholder="نهاية التكليف"
                                            id="chargingEndDateId"
                                            style="width: 100%" value="#{chargingBean.chargingEndDate}" />
                                        <p:outputLabel value="صلاحية التكليف" />
                                        <p:selectOneMenu 
                                            required="true"
                                            requiredMessage="صلاحية التكليف مطلوبة"
                                            id="chargingprivilageId"
                                            style="width: 300px" value="#{chargingBean.chargingPrivilage}" >
                                            <f:selectItem itemLabel="أختر  الصلاحية أثناء التكليف" itemValue="" />
                                            <f:selectItems value="#{chargingBean.allUserRoles}" />
                                        </p:selectOneMenu>

                                    </p:panelGrid>
                                    <p:messages autoUpdate="true" />
                                </div>



                                <div class="row">
                                    <div class="col-md-4"></div>
                                    <div class="col-md-4">
                                        <p:commandButton value="حفظ" 
                                                         action="#{chargingBean.CreateChargingBtn(actionEvent)}"
                                                         icon="fa fa-save" 
                                                         update="
                                                         :tempform:chargingpageId:chargingformId:whoischargedid,
                                                         :tempform:chargingpageId:chargingformId:whoisNotHereid,
                                                         :tempform:chargingpageId:chargingformId:chargingNameId,
                                                         :tempform:chargingpageId:chargingformId:chargingstartdateId,
                                                         :tempform:chargingpageId:chargingformId:chargingEndDateId,
                                                         :tempform:chargingpageId:chargingformId:chargingprivilageId"                                                        
                                                         process="@this,
                                                         :tempform:chargingpageId:chargingformId:whoischargedid,
                                                         :tempform:chargingpageId:chargingformId:whoisNotHereid,
                                                         :tempform:chargingpageId:chargingformId:chargingNameId,
                                                         :tempform:chargingpageId:chargingformId:chargingstartdateId,
                                                         :tempform:chargingpageId:chargingformId:chargingEndDateId,
                                                         :tempform:chargingpageId:chargingformId:chargingprivilageId"
                                                         style="width: 100%" />
                                    </div>
                                    <div class="col-md-4">

                                    </div>
                                </div>

                            </div>
                        </h:form>
                    </p:dialog>


                </h:form>
            </ui:define>
        </ui:composition>

    </body>
</html>
